{"componentChunkName":"component---src-templates-post-tsx","path":"/xay-dung-phan-comment-dam-chat-dev-voi-github-va-giscus-cho-blog/","result":{"data":{"post":{"headings":[{"id":"blog-của-minh","depth":2,"value":"Blog của mình"},{"id":"minh-da-xay-dựng-blog-nay-thế-nao","depth":3,"value":"Mình đã xây dựng blog này thế nào?"},{"id":"thế-blog-của-minh-co-vấn-dề-gi","depth":3,"value":"Thế blog của mình có vấn đề gì?"},{"id":"nhung-comment-vao-blog","depth":2,"value":"Nhúng comment vào blog"},{"id":"github-discussion","depth":3,"value":"Github discussion"},{"id":"implement-giscus-vao-gatsby","depth":3,"value":"Implement Giscus vào Gatsby"}],"tableOfContents":"<ul>\n<li>\n<p><a href=\"#blog-c%E1%BB%A7a-minh\">Blog của mình</a></p>\n<ul>\n<li><a href=\"#minh-da-xay-d%E1%BB%B1ng-blog-nay-th%E1%BA%BF-nao\">Mình đã xây dựng blog này thế nào?</a></li>\n<li><a href=\"#th%E1%BA%BF-blog-c%E1%BB%A7a-minh-co-v%E1%BA%A5n-d%E1%BB%81-gi\">Thế blog của mình có vấn đề gì?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#nhung-comment-vao-blog\">Nhúng comment vào blog</a></p>\n<ul>\n<li><a href=\"#github-discussion\">Github discussion</a></li>\n<li><a href=\"#implement-giscus-vao-gatsby\">Implement Giscus vào Gatsby</a></li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"Xây dựng phần comment đậm chất dev với github và giscus cho blog","path":"/xay-dung-phan-comment-dam-chat-dev-voi-github-va-giscus-cho-blog","tags":["Web"],"excerpt":"Về phần comment thì chúng ta có nhiều lựa chọn, tuy nhiên 2 anh lớn nhất chính là Facebook và Discus đều được mình loại trừ. Vậy ứng cử viên số 1 phải là Github discussion rồi.","created":"2023-03-19T09:47:56.476Z","createdPretty":"19 March, 2023","updated":"2023-03-19T09:47:56.476Z","updatedPretty":"19 March, 2023","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB2UlEQVQoz32S6W4TMRRG8wpQiWYmyWzePfYsaZMQkrZUrZB4/wc6yE5TKEj8OLr3szWf7zKLtTTU9xP1FKiE4tOXgs+3ZebmdvVHXr7nV32zTKxyzOfLFYtkYnxA2x7leqTrUT4RMCGi+4BO933I5ylXV+16hPFo19Noh/CRRVm3ubKd7PHHAfc44Y8jZh9wpxF/GnHHAb2PuPOIPQ4ZcxxQu0BlFGXVsKpbktdiVXfUUnNSkfP9xDxHurmnGR1FJyjajrUQrDtxiUKwkfJNy6yTx6q5sEjOG6l4UJEXP7M7jOwfZu52kaG39M7kl//H1Swb5palJghLVBZnNd5oequIvSF4k9spqub947Jpf/OX+WLTCpT1bDpBowyNNKyFQsWJjdCZNGNpfR5NrqQVH6r6UOGqk5RCU2jPxkUq09N0lskNSGUQxtIIlam6NK/LAv7hari2nnB6JL78RJ++0x6e8HdPRBHZKEcbJyo/cNtplglhWErLUlx0IQyFtJRpFLllKTm//uD8/Mr88IzYn9HzATftkeMd7bDNpm0YEcOWLs6ZJoz5vrIhP5ArTIZ5/WGi2J1Z33+jnr6izJZD63HWo7ynfmu5lZpG6hxrIXOs0sjSf5iX1fELx3U56DUEGR8AAAAASUVORK5CYII=","aspectRatio":1.9047619047619047,"src":"/static/d1ab3650b6cce38bb66e0a9e7e04b751/bc8e0/gatsby-cli-tao-bai-viet.png","srcSet":"/static/d1ab3650b6cce38bb66e0a9e7e04b751/8ac63/gatsby-cli-tao-bai-viet.png 200w,\n/static/d1ab3650b6cce38bb66e0a9e7e04b751/3891b/gatsby-cli-tao-bai-viet.png 400w,\n/static/d1ab3650b6cce38bb66e0a9e7e04b751/bc8e0/gatsby-cli-tao-bai-viet.png 800w,\n/static/d1ab3650b6cce38bb66e0a9e7e04b751/0101b/gatsby-cli-tao-bai-viet.png 976w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"html":"<p>Mấy nay mình quay lại viết blog, thế là phát hiện ra cái blog build bằng Gatsby của mình cũng đã được hơn 3 năm tuổi, có nhiều thứ cũ kĩ quá thì chúng ta cũng nên update, và blog cũng vậy.</p>\n<p>Gatsby là một static site generator (SSG) rất nổi tiếng từ hồi 3-4 năm trước, với hơn 50k stars trên github, điểm mạnh là nhanh gọn, và có thể host free trên github page hoặc netlify nên mình đã quyết định chọn em nó.</p>\n<h2 id=\"blog-của-minh\" style=\"position:relative;\"><a href=\"#blog-c%E1%BB%A7a-minh\" aria-label=\"blog của minh permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Blog của mình</h2>\n<p>Mình thấy việc học bằng cách dạy lại cho người khác, cũng như tổng hợp lại kiến thức của mình để chia sẻ rất hiệu quả, cho nên mình quyết định làm video và viết blog.</p>\n<h3 id=\"minh-da-xay-dựng-blog-nay-thế-nao\" style=\"position:relative;\"><a href=\"#minh-da-xay-d%E1%BB%B1ng-blog-nay-th%E1%BA%BF-nao\" aria-label=\"minh da xay dựng blog nay thế nao permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mình đã xây dựng blog này thế nào?</h3>\n<p>Vào năm 2019, kiến thức về React của mình hầu như bằng 0, cho nên mình lấy luôn một starter theme và chỉnh sửa đôi chút, sau đó chỉ focus vào việc viết bài mà thôi.</p>\n<p>Nhưng rồi sau đó khi lượng bài viết càng nhiều, thì vấn đề nó lại tòi ra.</p>\n<p>Một vấn đề mình fix được chính là tối ưu hóa lại quá trình tạo bài mới bằng việc tạo 1 CLI tool.</p>\n<p>Để mỗi lần tạo bài viết cho gatsby thì không cần phải lặp lại quá trình này:</p>\n<ol>\n<li>Vào folder content tạo 1 folder mới với slash gạch ngang dạng “bai-viet-moi”</li>\n<li>Mở folder “bai-viet-moi” để tạo file index.md</li>\n<li>Mở file markdown vừa tạo, thêm phần frontmatter cho nó như tiêu đề, path, ngày tạo bla blo…</li>\n</ol>\n<p>Nói chung là lằng nhằng!</p>\n<p>Mình viết 1 command tool với nodejs, chỉ cần 2 dòng gõ tiêu đề và tag, CLI tự động tạo luôn các phần còn lại:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 976px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d1ab3650b6cce38bb66e0a9e7e04b751/798d4/gatsby-cli-tao-bai-viet.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABx0lEQVQoz3WSaU4bQRBGfYUEKXjG9my9b7MAtuPYQBAoUu5/oBdN2ywRyY+nWlpd9VV1L+q7kXqMVELx5VvB1+syc3W9+uCXb/5rfLWcWWWb8xd/YXxE24ByAekCys9ETEzoENHzeYg5P/vqNXYBYTzaBRrtED7l3GJWtpUBf+hxDyP+MGB2EXcc8McBd+jRu4Q7DdhDnzGHHrWNVEZRVg2ruqW8sKil5qgSp7uRaUp0U6AZHEUnKNqOtRCsO3G2QrCR8hLLHK/qjlXzzmIjFfcq8ewntvuB3f3E7TbRB0tw5q3z//hYLBespCYKS1IWZzXeaIJVpGCI3uRxiqp5u1w27Tv/aLBQ1rPpBI0yNNKwFgqVRjZCZ+YdS+uZV5NVtOKTqr8UlkJTaM/GJSoTaDrL6HqkMghjaYTKVN28r/MDfOJjwXh8ID3/Rh9/0u4f8bePJJHYKEebRirfc91pljPCsJSWpTjHhTAU0lLOq3gd+fTyi9PTC9P9E2J3Qk973LhDDre0/U0u2sYB0d/QpSnTxCGfVzbmBlndReliHUeK7Yn13Q/q8TvK3LBvPc56lPfUl5FbqWmkzrYWMtuqk+d/mB/rXPQPq845snPbZuIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Gatsby CLI để tạo bài viết mới\"\n        title=\"Gatsby CLI để tạo bài viết mới\"\n        src=\"/static/d1ab3650b6cce38bb66e0a9e7e04b751/798d4/gatsby-cli-tao-bai-viet.png\"\n        srcset=\"/static/d1ab3650b6cce38bb66e0a9e7e04b751/5a46d/gatsby-cli-tao-bai-viet.png 300w,\n/static/d1ab3650b6cce38bb66e0a9e7e04b751/0a47e/gatsby-cli-tao-bai-viet.png 600w,\n/static/d1ab3650b6cce38bb66e0a9e7e04b751/798d4/gatsby-cli-tao-bai-viet.png 976w\"\n        sizes=\"(max-width: 976px) 100vw, 976px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Gatsby CLI để tạo bài viết mới</p>\n<p>Package cli của mình ở đây: <a href=\"https://www.npmjs.com/package/gatsby-tool-cli\">https://www.npmjs.com/package/gatsby-tool-cli</a></p>\n<p>Tham khảo: <a href=\"https://devgiangho.github.io/cach-tao-1-blog-bang-gatsbyjs-va-deploy-len-github\">Cách tạo 1 blog bằng gatsbyjs và deploy lên github</a></p>\n<h3 id=\"thế-blog-của-minh-co-vấn-dề-gi\" style=\"position:relative;\"><a href=\"#th%E1%BA%BF-blog-c%E1%BB%A7a-minh-co-v%E1%BA%A5n-d%E1%BB%81-gi\" aria-label=\"thế blog của minh co vấn dề gi permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Thế blog của mình có vấn đề gì?</h3>\n<p>Well, hôm nay quay trở lại viết blog thì mình mới nhận ra là blog mình không có hệ thống comment. Trước đây mình lười nên bỏ ngỏ, hôm nay rảnh chút nên tập trung làm nốt.</p>\n<p>Thực ra nó còn thiếu cả phần navigation previous và next post, mình có thêm luôn, tuy nhiên bài này mình focus vào phần comment thôi ha.</p>\n<h2 id=\"nhung-comment-vao-blog\" style=\"position:relative;\"><a href=\"#nhung-comment-vao-blog\" aria-label=\"nhung comment vao blog permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nhúng comment vào blog</h2>\n<p>Về phần comment thì chúng ta có nhiều lựa chọn, tuy nhiên 2 anh lớn nhất chính là Facebook và Discus đều được mình loại trừ.</p>\n<p>FB thì mình không thích, hoặc có thể nhiều anh em không thích.</p>\n<p>Disqus thì load nặng, và cũng bị vấn đề gì mà đôi lúc mình không vào được, may be do VN mình chặn hoặc do nó chặn VN mình.</p>\n<p>Vậy ứng cử viên số 1 phải là Github discussion rồi.</p>\n<h3 id=\"github-discussion\" style=\"position:relative;\"><a href=\"#github-discussion\" aria-label=\"github discussion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Github discussion</h3>\n<p>Anh em đọc blog của mình chủ yếu là dev, mà dev thì ai mà chẳng có github.</p>\n<p>Thế là quá hợp lý!</p>\n<p>Để sử dụng Github discussion làm hệ thống comment thì chúng ta phải sử dụng app thứ 3.</p>\n<p>Chúng ta có 2 ứng cử viên cho vụ này là <a href=\"https://utteranc.es/\">Utterances</a> và <a href=\"https://giscus.app/\">Giscus</a></p>\n<p>Mình tham khảo và bỏ qua Utterances, bởi vì 2 nhược điểm:</p>\n<ul>\n<li>Không có post reaction như Giscus</li>\n<li>Không scope lại phần reply comment, mà các comment đều bị flatten</li>\n</ul>\n<p>Okay, bắt đầu vào làm thôi</p>\n<h3 id=\"implement-giscus-vao-gatsby\" style=\"position:relative;\"><a href=\"#implement-giscus-vao-gatsby\" aria-label=\"implement giscus vao gatsby permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Implement Giscus vào Gatsby</h3>\n<p>Chúng ta phải có 3 thứ:</p>\n<ul>\n<li>Blog, dĩ nhiên rồi</li>\n<li>Github account</li>\n<li>1 public repo (ở đây mình dùng luôn repo public của blog trên github page)</li>\n</ul>\n<p>Đầu tiên, phải thêm app Giscus vào repo githubpage của các bạn trước:</p>\n<p>Vào phần settings trên repo public mà bạn muốn dùng, <strong>bật tính năng discussion</strong>.</p>\n<p>Truy cập vào đây: <a href=\"https://github.com/apps/giscus/installations/new\">https://github.com/apps/giscus/installations/new</a>, chọn repository bạn muốn, grant quyền cho em nó.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 687px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/13f4fdafd01cbb13d8f47fdd61f0f529/aec65/install-giscus.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 124.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAAsTAAALEwEAmpwYAAACmElEQVQ4y6VUy27bMBD0B/Uv+kU999SP6T/03N6Knoq2gR+JkzixJOstvkRS1BS7sh3Flo0UJTDgipSGM7tLzXTrcAplLOMQyz3Ga4f4FLOpxSP4Q4fQdehD4FhfILpKeDhdaAsaX3+u8eXHimNaG7/zTwrJZtd1eExK3G1zjqV5A+GwaS9YHkgDWT5x8IKXnM5OEz1OeC0Ubha3uJmv8OvPHIvVGrXQr0hPCzgbb7auQ2s9jPVo3TA3UjOInGZzosqHnt87KjwQOu/RNAKNEBBS8kzPWmtIqaC0hhCS90LoEfqei7TZbCCVOpIeCb3vUDcNlNJQSkEIgbIsUdU1qrpBXTfI8wKNkOj7nkFjuVzy2jlhFyClRBzHeN5GyIsS40EEpIqKQ4cTnPO814X+3DItkqX1/SPWDxs8b2MkuxRxkiKKE+zSbLAsJFsUUrF9ax2LOSPkU52D28NaC60Nx2FkcWrQtyPCQ68FRFGE+WKJ27t7rFa3+H2zQJYXTEa9eMjdGEzYddOWSU2aFWyPiJJdhqKshmobc8zlmwgpD7SxywrOW5LmeI4SFFVzbJFT29cVdoETTMlurYXSZjJfkwr9BYWUJ2qXNMux26VIkh3P/JxmMMaAKKh1iIyUDQjThDTatuUPjWm5LaqqRl3X3PSU4/E4VP814T4gu3QT0iwbVKYZyqr6D8u+gzaalZAyal66z3QQE7HV/gys0E+2TUBWF3h4eEQUx5y7bRSxampySsVAO9HYF6tsWsiygagF8qJgtYSiKLkfw1saW+1vivUeia3w1OaovLrYMmGMKcsUtK1HbgTef/+Ed98+4OP8M4IGytoNNlnJlbs8rvKg0MFYh0iVeJIZk9Op1nk4+k1dAb3Xjv7YfwEa3JbsRV+NQQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cài giscus\"\n        title=\"cài giscus\"\n        src=\"/static/13f4fdafd01cbb13d8f47fdd61f0f529/aec65/install-giscus.png\"\n        srcset=\"/static/13f4fdafd01cbb13d8f47fdd61f0f529/5a46d/install-giscus.png 300w,\n/static/13f4fdafd01cbb13d8f47fdd61f0f529/0a47e/install-giscus.png 600w,\n/static/13f4fdafd01cbb13d8f47fdd61f0f529/aec65/install-giscus.png 687w\"\n        sizes=\"(max-width: 687px) 100vw, 687px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Config widget của giscus:</p>\n<ol>\n<li>Vào <a href=\"https://giscus.app/\">https://giscus.app/</a></li>\n<li>Config các option như language, theme, position theo ý thích, có thể tạo thêm 1 category discussion là “Comments” cho dễ phân loại.</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 815px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/91414f15a4888acaea3a405e397e764f/ef916/config-giscus-options.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACAUlEQVQ4y5VUi3LjIAzs/3/ftTeN21z9fgHGD8A2dvZGcuskl2vTMqMRBrHsIskPURTj6fczDocAz4cA4ziBxrquOJ1OPzI689B1HWohMRiD74/TeUZAl4BxnDCzoqwwjiOstWx0gXOObVtzMMbAugXGrrDOYRgGLMuygzNgPwwwxoJ827YMRIFt1zEA7dE37ZOawXgMw8p79O3fAXeGG5PxQsTPB4HtDLO8AMkWUt09dH7824TsgHlRoixLCCG2N7Ik2fCbkVQymn/F7AqQDhSlQBRnSLMKSdKhKEpUVY28KFDVFcqqhGoUdKvZCykxz/MV83NS+h5BkOHxKeRs/3oM8PJ6xPH4B1GUIook4lggjEq8hRXSrEZV15yk/wIKIVnuODpM04RpnthTuUyTxzgCRMZ78Hxd70gmaWmaQykNpRr2fW8ubl/hV4/1tOxFfcnqhqEee0ijIYZmN2U70Ho/2b2+rjNK/hOGxhr4xcM4C0ed4hxojepz9vPd2rsBfAsjlpqkKcIwQpJs/hC8QEpFXLi9PuyD7b+1eZasNZqm4cNkqmmg25YvkUrxnFqMYrZYfVUyNwwpKE5STkyW5UjSjC2KE0jVYJpmfop+MPuT0NqnDIkJAVELUteQJ0DV6O3vw3+bzbz3XFLkvwBU3MfiXS6xIjDddjuQsZaDv5OUv4NKd7RXQcdZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Config giscus options\"\n        title=\"Config giscus options\"\n        src=\"/static/91414f15a4888acaea3a405e397e764f/ef916/config-giscus-options.png\"\n        srcset=\"/static/91414f15a4888acaea3a405e397e764f/5a46d/config-giscus-options.png 300w,\n/static/91414f15a4888acaea3a405e397e764f/0a47e/config-giscus-options.png 600w,\n/static/91414f15a4888acaea3a405e397e764f/ef916/config-giscus-options.png 815w\"\n        sizes=\"(max-width: 815px) 100vw, 815px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ol start=\"3\">\n<li>Ta nhận được 1 widget như sau:</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 795px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/26e983d4a12d7b665d45540813dd7b27/65c7b/giscus-widget.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA86AAAPOgGXOdvCAAABmElEQVQoz4XSy4rUQBQG4H7/pxhQUHEjXjYDA7pwqcMIbjpMX5JUku501blU6l5JJExv7GnHn39Ri/PBoTgrpVRZVlUl2sMh5Txfy3Qt4zStELFpu7puumPfdceuaVoh6rISVV3u9kI0TdNKqYgIEAEQkJgZEPM4rqzzCglIA2pig2lUSyeeZ55mNo5Yh5hSHi+64JAymqFpdVnRphD7T3f1h1vx+U7eftXfvltknyfro3nWmPIqxORDrGu9LuixOFQ37+DmtX77nl+90R+/GB5sSNYH6+NFz9iFWAter2Gzk/Tw2/64dw+/3M9797ixMT9nl1i0w3ZHux1vW3tyyc+znWc7Tv+Sf+Nm2G5xX0JVybZTfc+srbu27QXOPibRDEUB2/3x2NNggzbeuJfkGfuYyBjR8qE3Ckx/Wr7IhfiyPOOYEplhcD7mHHNOeXza5X9dJlfW2uVilhAASKmQEEABsgJm1gpQLbcFUilAAsDTScm+DzEuGBCllICEy8Mw+YEBcCTKiEYqqRQSR0QmioijlMEbPU3zH7K04c9tJ11EAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Giscus widget\"\n        title=\"Giscus widget\"\n        src=\"/static/26e983d4a12d7b665d45540813dd7b27/65c7b/giscus-widget.png\"\n        srcset=\"/static/26e983d4a12d7b665d45540813dd7b27/5a46d/giscus-widget.png 300w,\n/static/26e983d4a12d7b665d45540813dd7b27/0a47e/giscus-widget.png 600w,\n/static/26e983d4a12d7b665d45540813dd7b27/65c7b/giscus-widget.png 795w\"\n        sizes=\"(max-width: 795px) 100vw, 795px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><strong>Đưa widget vào Gatsby</strong>\nCái widget mà trên giscus cung cấp chỉ có thể nhúng trên 1 trang html bình thường, nhưng Gatsby là SSG sử dụng React, do đó chúng ta phải cài thêm 1 thư viện:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> @giscus/react</code></pre></div>\n<p>Thêm component comment, cũng thêm chút styling css:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> FunctionComponent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> styled <span class=\"token keyword\">from</span> <span class=\"token string\">\"styled-components\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Giscus <span class=\"token keyword\">from</span> <span class=\"token string\">\"@giscus/react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> PostComment <span class=\"token operator\">=</span> styled<span class=\"token punctuation\">.</span>div<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  margin: 2rem auto;\n  max-width: 800px;\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> Comments<span class=\"token punctuation\">:</span> <span class=\"token function-variable function\">FunctionComponent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PostComment</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Giscus</span></span>\n      <span class=\"token attr-name\">repo</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>devgiangho/devgiangho.github.io<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">repoId</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>repoId<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">category</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Comments<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">categoryId</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>categoryId<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">mapping</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>url<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">strict</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">reactionsEnabled</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">emitMetadata</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">inputPosition</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>top<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">theme</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>preferred_color_scheme<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">loading</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>lazy<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">cross-origin</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>anonymous<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">PostComment</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Comments<span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>Giới hạn các domain được load comments:</strong></p>\n<p>Để ngăn chặn các trang khác lấy comment từ web bạn, tạo 1 file <em>giscus.json</em> trong repo public mà chúng ta dùng để connect discussion, thêm origin hoặc regex cho nó:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"origins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"https://devgiangho.github.io\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Các trang không được phép show comment sẽ bị chặn:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 882px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/96523cca8bc0fff73449cc5709dffa5b/90712/setup-origin-giscus-refuse-connect.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA86AAAPOgGXOdvCAAAAfUlEQVQY06XQMQ4DIQxEUd//RogTIA6BDNgEEYmAzEKXFKlYyn31L0YD3wdgrVVr/RxaayEEZu69n0Gt9bomiAgRpV3OOYRgjNFaxxjTgYhaazDGYObXjogQ0VqrlEJE5nQL/otgzllKee+894jonIsxMhMR34JSiojAk8N+xDZRiXoSuIoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Giscus chặn comment\"\n        title=\"Giscus chặn comment\"\n        src=\"/static/96523cca8bc0fff73449cc5709dffa5b/90712/setup-origin-giscus-refuse-connect.png\"\n        srcset=\"/static/96523cca8bc0fff73449cc5709dffa5b/5a46d/setup-origin-giscus-refuse-connect.png 300w,\n/static/96523cca8bc0fff73449cc5709dffa5b/0a47e/setup-origin-giscus-refuse-connect.png 600w,\n/static/96523cca8bc0fff73449cc5709dffa5b/90712/setup-origin-giscus-refuse-connect.png 882w\"\n        sizes=\"(max-width: 882px) 100vw, 882px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><strong>Thông báo khi có comment mới:</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1083px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/12c8e0856d752c465976428ca18cca6a/eb4a1/comment-notification-email.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB2UlEQVQoz42QS3ObQBCE+f//JjnknEMOsexYjoxsIyNgAUmFhXgKWJbHl9pV4tipHDxVUzs7293Ts5azEfjBjniXEO9fCOOEbbDH9fc8ezvsp4D1JuLhOcJ2BKtHj/snj7UTcGe73Nlb7h98g/36bYk1z/ByfCGKIoQQiDBEiJAwjAgCQRzHhOH7exRdeofDgfP5jFIDUnY8OVsswDx4nofjOEbUdV1DPB6PnE4nkxqTZRlpmr72lVKazqxdAZ4XYqXVTJYVJElC0zRIKWnblr7v+UgMw/CK9bYC68ZVpFlBmh7pus4I/jn1gLep13tb68FlWZJlueG4zz6Wn0wUZU1dVwZY17V51PUw/F3pberQ68quYxyHV5zwI6y1UJyy0qxcFAV5npv/yfKCqpFo/r+CujdNkxGtW0V5lowzhPoPtbLsJWVVmvMyvTfEYTT+/iM4/3YOUk20crw49ATWOE5UeUVxKqjziq7pafuJtlN0naLpBuPG5DgxvsuR2fQHI+hvg4vDeZzopaJtJWXdkZ0V+bknryVFo/hoHJMUa7FYcn+3ZmM/snc2VIFPHQvySFDuYg5ewCGI8J0tq6XN7Y8VP25WXN+sWFyvuFr85PvVLbdLm8+fvvALB2VElOtlWoIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Email khi có comment\"\n        title=\"Email khi có comment\"\n        src=\"/static/12c8e0856d752c465976428ca18cca6a/eb4a1/comment-notification-email.png\"\n        srcset=\"/static/12c8e0856d752c465976428ca18cca6a/5a46d/comment-notification-email.png 300w,\n/static/12c8e0856d752c465976428ca18cca6a/0a47e/comment-notification-email.png 600w,\n/static/12c8e0856d752c465976428ca18cca6a/eb4a1/comment-notification-email.png 1083w\"\n        sizes=\"(max-width: 1083px) 100vw, 1083px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><strong>Bug:</strong> Mình gặp 1 bug lúc deploy là không thể login vào giscus iframe.\nLý do là bởi vì Gatsby đã tự động remove trailing slash, do đó nó auto remove các query param phía sau.</p>\n<p>Ví dụ url của mình dạng <code class=\"language-text\">devgiangho.github.io/abc/?giscus=xxxx</code>, thì gatsby auto remove slash, chỉ còn <code class=\"language-text\">devgiangho.github.io/abc</code></p>\n<p>Do đó mình phải tắt chế độ này bằng cách thêm 1 option vào gatsby-config:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">trailingSlash<span class=\"token punctuation\">:</span> <span class=\"token string\">\"always\"</span></code></pre></div>\n<p><strong>Tối ưu để giscus được prefetch trước:</strong></p>\n<p>Để lúc user đang đọc bài, chưa kéo tới phần comment thì các script cũng đã được load sẵn, mình có follow cái blog này<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>link rel<span class=\"token operator\">=</span><span class=\"token string\">\"preconnect\"</span> href<span class=\"token operator\">=</span><span class=\"token string\">\"https://giscus.app\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>link rel<span class=\"token operator\">=</span><span class=\"token string\">\"dns-prefetch\"</span> href<span class=\"token operator\">=</span><span class=\"token string\">\"https://giscus.app\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></code></pre></div>\n<p>Kết quả các bạn có thể thử luôn ở phía bên dưới ⬇️⬇️</p>\n\n      <div class=\"footnotes\">\n        <hr/><strong>References:</strong>\n        <ol >\n    \n    <li class=\"footnote-list-item\" id=\"fn-1\" >\n          \n        \n      <a href=\"#fnref-1\" class=\"footnote-backref\" style=\"display:inline;text-decoration: none;\">\n        ↩\n      </a>\n    <p class=\"footnote-paragraph\" style=\"display:inline; margin-left: 5px;\"><a href=\"https://www.brycewray.com/posts/2022/07/more-tips-using-giscus/\">Bryce Wray's blog</a>.</p>\n      </li>\n      \n    </ol></div>"},"primaryTag":{"name":"Web","color":"#007acc"},"prev":{"frontmatter":{"title":"Authentication với JWT, lưu token ở đâu là bảo mật nhất?","path":"/authentication-voi-jwt-luu-token-o-dau-la-bao-mat-nhat"}},"next":null},"pageContext":{"postId":"0a0c8960-1972-5e1f-bf50-2d6569e9564e","primaryTag":"Web","prevId":"b22f4b39-b943-59eb-ade8-327f4f44f9dc","nextId":null}},"staticQueryHashes":["1116962356","2275848304","3082461530","3089453468","545095672"]}