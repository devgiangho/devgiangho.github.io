{"componentChunkName":"component---src-templates-post-tsx","path":"/connection-pooling-tong-quan-va-implement-benchmark/","result":{"data":{"post":{"headings":[{"id":"first-thing-first","depth":2,"value":"First thing first"},{"id":"database-connection","depth":2,"value":"Database connection"},{"id":"connection-pool-la-gi","depth":3,"value":"Connection pool l√† g√¨?"},{"id":"n·ª≠a-phut-qu·∫£ng-cao","depth":3,"value":"N·ª≠a ph√∫t qu·∫£ng c√°o"},{"id":"connection-pooling-trong-database","depth":3,"value":"Connection pooling trong database"},{"id":"cach-implement-connection-pooling","depth":3,"value":"C√°ch implement connection pooling"},{"id":"benchmark-connection-pooling","depth":2,"value":"Benchmark connection pooling"},{"id":"m·ªôt-vai-khai-ni·ªám","depth":3,"value":"M·ªôt v√†i kh√°i ni·ªám"},{"id":"d·ª±ng-database-postgres-va-data","depth":3,"value":"D·ª±ng database postgres v√† data"},{"id":"d·ª±ng-api-b·∫±ng-go","depth":3,"value":"D·ª±ng API b·∫±ng Go"},{"id":"k·∫øt-qu·∫£-test-benchmark","depth":3,"value":"K·∫øt qu·∫£ test benchmark"},{"id":"benchmark-hardcore-h∆°n","depth":3,"value":"Benchmark hardcore h∆°n"},{"id":"k·∫øt-lu·∫≠n","depth":2,"value":"K·∫øt lu·∫≠n"}],"tableOfContents":"<ul>\n<li>\n<p><a href=\"#first-thing-first\">First thing first</a></p>\n</li>\n<li>\n<p><a href=\"#database-connection\">Database connection</a></p>\n<ul>\n<li><a href=\"#connection-pool-la-gi\">Connection pool l√† g√¨?</a></li>\n<li><a href=\"#n%E1%BB%ADa-phut-qu%E1%BA%A3ng-cao\">N·ª≠a ph√∫t qu·∫£ng c√°o</a></li>\n<li><a href=\"#connection-pooling-trong-database\">Connection pooling trong database</a></li>\n<li><a href=\"#cach-implement-connection-pooling\">C√°ch implement connection pooling</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#benchmark-connection-pooling\">Benchmark connection pooling</a></p>\n<ul>\n<li><a href=\"#m%E1%BB%99t-vai-khai-ni%E1%BB%87m\">M·ªôt v√†i kh√°i ni·ªám</a></li>\n<li><a href=\"#d%E1%BB%B1ng-database-postgres-va-data\">D·ª±ng database postgres v√† data</a></li>\n<li><a href=\"#d%E1%BB%B1ng-api-b%E1%BA%B1ng-go\">D·ª±ng API b·∫±ng Go</a></li>\n<li><a href=\"#k%E1%BA%BFt-qu%E1%BA%A3-test-benchmark\">K·∫øt qu·∫£ test benchmark</a></li>\n<li><a href=\"#benchmark-hardcore-h%C6%A1n\">Benchmark hardcore h∆°n</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#k%E1%BA%BFt-lu%E1%BA%ADn\">K·∫øt lu·∫≠n</a></p>\n</li>\n</ul>","frontmatter":{"title":"Connection pooling: T·ªïng quan v√† implement benchmark","path":"/connection-pooling-tong-quan-va-implement-benchmark","tags":["Backend","Web","Go"],"excerpt":"M√¨nh mu·ªën ti·∫øp t·ª•c b·∫±ng t·ªëi ∆∞u hi·ªáu nƒÉng database, ph·∫ßn ƒë·∫ßu ti√™n s·∫Ω l√† connection pooling. V·∫≠y connection pooling l√† g√¨? S·ª≠ d·ª•ng connection pool nh∆∞ th·∫ø n√†o?","created":"2023-03-29T15:06:30.504Z","createdPretty":"29 March, 2023","updated":"2023-03-29T15:06:30.504Z","updatedPretty":"29 March, 2023","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACxElEQVQoz4XT+U/ScRzHcX9P12rrWKtW64dalh1kaa227rJzmZmyoH0jLTHUig5NQTrUwkoghThMjeycIKD5lUTxAEMT1My2/pdnG9U6VusfeOzzee/1TEh0ZzPLI2WeV84i3xmWdeazQiwgpbsIif8iaQE123qvsytYzv6BSo4M3eZ4qJqcYT3yyEMUIyYKPpgpjlpRjzeSEAfbpczzyVggnmKJKLBcPEdyTwHrgyrSA2q29l5nR/AG+wa0HBq8Reb/wNmeXOa2y0m2aUi/Z2LzHTOb9SZSm3Rs6rnM9r4y9vVrOTRwk2NDVWSH7v4bTHKdJMmXhaRFxwFVB+vlL1grf85G4TVHLnvY0FpOyYcGWif82GJeXk8FaJkUkYb0yCIPOfs3MLEjk42N1bS4Y2gtbRTWvKC49hWCrp1Um46McAUngtVk99egCNeR/95ETvjbC/8BHmeD4xaqOy85X+tEqHaiqGrioPIxKTYNipH7tEyIPJnopD7mpj7q4ulHMY4pRk0ox8wU/QmmNVeh0Dwjo9TOUY2TwvvPySxxsM5eyeGwlvwhI+dCRpTD9eSHjFwasXI6Uofs/QMUI0aKo7YfYA4zvMdIs9agt/rR1JnJrXQgaBvIKmpmpaGUwpgJy7iXxukuGiY9NE2LqMINNH56i3Paj/vLIHejLymJ2klIdJ1kpi+bpTYVZTYPbW4vJToLsmt29qhtJDcXkzdqoDzShHnKi2G8DftUJw+ib7B89GIcd+H8/A7DpItLMceP2UiZ45OysPUMEsdVtlrLkFivsKZNRXqfmvTAFbb0Xo3PZ2+/loODN8kK15A7rI9/WYgYuDBm+WXYHinzvXIWdgks7hZY5s9jVUCJpPciaT1qtvWVsjtYQcaAjqNDt79jtfEb5o0+onDM8vOGP9OTsahD+JZel5LVouq39HZ+T+/wf9L7Cp0ra1mXPMXRAAAAAElFTkSuQmCC","aspectRatio":1.6666666666666667,"src":"/static/5d70a032bfc7060682647360314a9e25/bc8e0/blog-database-connection-pooling.png","srcSet":"/static/5d70a032bfc7060682647360314a9e25/8ac63/blog-database-connection-pooling.png 200w,\n/static/5d70a032bfc7060682647360314a9e25/3891b/blog-database-connection-pooling.png 400w,\n/static/5d70a032bfc7060682647360314a9e25/bc8e0/blog-database-connection-pooling.png 800w,\n/static/5d70a032bfc7060682647360314a9e25/6e898/blog-database-connection-pooling.png 960w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"html":"<p>M·ªôt nh√† th√¥ng th√°i n√†o ƒë√≥ ƒë√£ n√≥i: ‚ÄúMu·ªën l√™n tr√¨nh backend, th√¨ database l√† m·ªôt ph·∫ßn kh√¥ng th·ªÉ b·ªè qua‚Äù.</p>\n<p>V√¢ng, trong series backend n√¢ng cao n√†y, m√¨nh mu·ªën ti·∫øp t·ª•c b·∫±ng t·ªëi ∆∞u hi·ªáu nƒÉng database, ph·∫ßn ƒë·∫ßu ti√™n s·∫Ω l√† connection pooling. V·∫≠y connection pooling l√† g√¨? S·ª≠ d·ª•ng connection pool nh∆∞ th·∫ø n√†o? H√£y tham kh·∫£o b√†i vi·∫øt n√†y nha.</p>\n<h2 id=\"first-thing-first\" style=\"position:relative;\"><a href=\"#first-thing-first\" aria-label=\"first thing first permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>First thing first</h2>\n<p>Again, m√¨nh l√† Ki√™n, m·ªôt anh dev v·ªõi tay ngh·ªÅ kh√° th·∫≠p c·∫©m, series backend n√¢ng cao n√†y ch√≠nh l√† m·ªôt trong nh·ªØng n·ªó l·ª±c c·ªßa m√¨nh ƒë·ªÉ ƒë√†o s√¢u kƒ© nƒÉng backend. Hi v·ªçng s·∫Ω c√≥ √≠ch v·ªõi c√°c b·∫°n, v√† c·∫£ m√¨nh n·ªØa ü§ó</p>\n<h2 id=\"database-connection\" style=\"position:relative;\"><a href=\"#database-connection\" aria-label=\"database connection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Database connection</h2>\n<p>N·∫øu theo d√µi series n√†y t·ª´ ƒë·∫ßu, b·∫°n s·∫Ω bi·∫øt v·ªÅ <a href=\"https://devgiangho.github.io/so-sanh-chi-tiet-tcp-va-udp-tai-sao-udp-nhanh-hon-udp/#three-way-handshake\">TCP handshake</a>, m√† ch∆∞a th√¨ b·∫°n c√≥ th·ªÉ ƒë·ªçc l·∫°i ƒë·ªÉ n·∫Øm v·ªÅ n√≥. V√† hi·ªÉn nhi√™n, c√°c database d·∫°ng RDBMS nh∆∞ MSSQL, MySQL, Postgresql ƒë·ªÅu support protocol giao ti·∫øp qua TCP/IP nh∆∞ m·ªôt ti√™u chu·∫©n, ƒë·∫∑c bi·ªát n·∫øu b·∫°n k·∫øt n·ªëi t·ªõi c√°c database t·ª´ xa, v√† ph·∫£i th√™m SSL/TLS ƒë·ªÉ b·∫£o m·∫≠t connection.</p>\n<p>Nh√¨n xem h√¨nh sau ƒë·ªÉ bi·∫øt lifecycle c·ªßa m·ªôt k·∫øt n·ªëi t·ªõi postgres DB:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 850px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/176f5a0c36e69ea2f8d7bddec59a92a9/ae694/connection-phase-db.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABdElEQVQoz4VTS07DMBDt4TgES9acgBU3YMWiR+ACHAHEBrEqSFUbAYmaVEqcxPk4dhL7oRmaKP3BSKM3ju2n5zeTGSZRFiWjcw7nYthTlLt6en5mreXidfGBi8srRELw2p4gHS86h/snD3cvIUxr9/Zm/Y7w+fMb1/M5ViL9JbSWDx0mBd25eXjD7eMXSt3vEw5FqTW8TYj2j+fyxR2+BwILX4xkR4TOOhSVQRLHiKIIQgiEYcj1drvlumka9H2PruvQtS1sb489HBbkWZIrlGWJqqoYi6KAlJIxCAIsl0t4nof1eoU4lVDGnldIhKlskKbpmKSS1CVJAmMMtNassjUGlTKodXdOoYN1QFZq+L7PSYo2mw0TZ1kGpRQnEWrdIJMV1EFDjgkLjTiOR88I8zxnQlI7kBdS/kdIY+IgK8MK6rpmHwckP4easlGKn6zMH4RTY4egZpAiIiGk7k6H3J76Uw4/TIeY1JJv1AxCGplT56fxAz9NoxHrAjr1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Postgres DB Connection phase\"\n        title=\"Postgres DB Connection phase\"\n        src=\"/static/176f5a0c36e69ea2f8d7bddec59a92a9/ae694/connection-phase-db.png\"\n        srcset=\"/static/176f5a0c36e69ea2f8d7bddec59a92a9/5a46d/connection-phase-db.png 300w,\n/static/176f5a0c36e69ea2f8d7bddec59a92a9/0a47e/connection-phase-db.png 600w,\n/static/176f5a0c36e69ea2f8d7bddec59a92a9/ae694/connection-phase-db.png 850w\"\n        sizes=\"(max-width: 850px) 100vw, 850px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Do ƒë√≥, n·∫øu m·ªói l·∫ßn c√≥ request, th√¨ n·∫øu application t·∫°o m·ªõi 1 connection t·ªõi DB, th√¨ s·∫Ω ph·∫£i th·ª±c hi·ªán handshake l·∫°i, l√∫c ƒë√≥ s·∫Ω r·∫•t t·ªën resource v√† l√†m ch·∫≠m app ƒëi. V√¨ v·∫≠y connection pooling ra ƒë·ªùi.</p>\n<h3 id=\"connection-pool-la-gi\" style=\"position:relative;\"><a href=\"#connection-pool-la-gi\" aria-label=\"connection pool la gi permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Connection pool l√† g√¨?</h3>\n<p>Th·ª±c ch·∫•t, connection pool l√† m·ªôt implementation c·ªßa design pattern <a href=\"https://sourcemaking.com/design_patterns/object_pool\">Object Pool</a>. Kh√° gi·ªëng v·ªõi singleton, ƒë√¢y l√† m·ªôt pattern ƒë∆∞·ª£c t·∫°o ra v·ªõi m·ª•c ƒë√≠ch ƒë·ªÉ c√≥ th·ªÉ s·ª≠ d·ª•ng l·∫°i ƒë∆∞·ª£c c√°c object m√† ch√∫ng ta mong mu·ªën.</p>\n<p>Dƒ© nhi√™n v·ªõi nh·ªØng thao t√°c ƒë·∫Øt ƒë·ªè nh∆∞ thi·∫øt l·∫≠p 1 k·∫øt n·ªëi m·ªõi t·ªõi DB th√¨ pattern n√†y l·∫°i qu√° ∆∞ l√† h·ª£p l√Ω.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 822px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/374171f1d48fb5fa39f64a74120885b2/f73a1/connection-pooling.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABz0lEQVQ4y42Ty2rbQBSG/QR9jb5EH6Bv0U3JO4Rusyh0212XLYRQCBSyyCKrFlqaBJyb7dhOYxErqWPZ8U3WZS76ysxYiiVCqOBw5pz5+ec/F9UAsiwj/8w5t/W4dOeCMnaVr+Xg5s2A/mia0/LfD1XyNb06fG/8odW/R8iM+TJFaW3zWmcl4upD1XxB+KN5XRCGscDkU6kJY0UiVEFuHwBEKvh6HfD2+JZP3RFRIsoKf156tG+HSOUUSqVZRNLaPJI2jhLJwzy2+BNvzOsPB7z71uLVxwv2Ww8VwlaPtj9ECEOUopRmGqbUOwO8wcKqXcaCYBpZ/O+rgM3tQ+7HM9586bB7Ni4T5iUbhYtI2B6GsSQWWJWpUCxjyWjmFDb8CS82dtj4fMrL9+fsNcbVkp3COFFM5oklFNKVnffwcbrYHu8e3bC132O7PiFaYQrCX5cenbvAbowpTcrHKVd37vkpa3d5cNrh3LtDKTflp9cjWzOQpgqlkWurVSz2Ik6Z2elmGHHG5+UZr3SGULlh4+qfVCLsD0NOukPOrgKOGj7N3siSurKh6884bvrU2385vOjjDcLnCc2epUIipCJJhfXuyi2y6anJG4zxBv8U4T/Nc+kpDqzdhgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"connection-pooling.png\"\n        title=\"connection-pooling.png\"\n        src=\"/static/374171f1d48fb5fa39f64a74120885b2/f73a1/connection-pooling.png\"\n        srcset=\"/static/374171f1d48fb5fa39f64a74120885b2/5a46d/connection-pooling.png 300w,\n/static/374171f1d48fb5fa39f64a74120885b2/0a47e/connection-pooling.png 600w,\n/static/374171f1d48fb5fa39f64a74120885b2/f73a1/connection-pooling.png 822w\"\n        sizes=\"(max-width: 822px) 100vw, 822px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Gi·ªëng nh∆∞ vi·ªác ch·ªü kh√°ch qua s√¥ng ·ªü b·∫øn ƒë√≤, c√≥ r·∫•t nhi·ªÅu thuy·ªÅn, nh∆∞ng ƒë·ªÉ m·∫∑c con thuy·ªÅn qu√° l√¢u d∆∞·ªõi n∆∞·ªõc s·∫Ω l√†m m·ª•c g·ªó nhanh h∆°n. N√™n thuy·ªÅn ƒë∆∞·ª£c c·∫•t v√†o kho.</p>\n<p>M·ªói l·∫ßn ch·ªü ng∆∞·ªùi qua l√† ph·∫£i: B√™ 1 chi·∫øc thuy·ªÅn t·ª´ kho b√™n b·ªù s√¥ng xu·ªëng, ch·ªü ng∆∞·ªùi qua b√™n kia b·ªù, r·ªìi ch·∫°y v·ªÅ, ƒë∆∞a thuy·ªÅn ƒëi c·∫•t => t·ªën th·ªùi gian.</p>\n<p>Trong khi ƒë√≥ ch√∫ng ta s·∫Ω ƒë·∫∑t t·ªëi ƒëa kho·∫£ng 100 chi·∫øc thuy·ªÅn neo ƒë·∫≠u b√™n c·∫°nh s√¥ng khi kh√¥ng c√≥ kh√°ch, m·ªói thuy·ªÅn s·∫Ω ƒë∆∞·ª£c d·ª´ng ngh·ªâ 1 bu·ªïi, h·∫øt bu·ªïi kh√¥ng c√≥ kh√°ch ng·ªìi thuy·ªÅn ƒë√≥ th√¨ m·ªõi ƒë∆∞a c·∫•t ƒëi.</p>\n<h3 id=\"n·ª≠a-phut-qu·∫£ng-cao\" style=\"position:relative;\"><a href=\"#n%E1%BB%ADa-phut-qu%E1%BA%A3ng-cao\" aria-label=\"n·ª≠a phut qu·∫£ng cao permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>N·ª≠a ph√∫t qu·∫£ng c√°o</h3>\n<p>G·∫ßn ƒë√¢y m√¨nh m·ªõi mua 1 cu·ªën s√°ch mang t√™n ‚ÄúL√†m ch·ªß c√°c m·∫´u thi·∫øt k·∫ø kinh ƒëi·ªÉn trong l·∫≠p tr√¨nh‚Äù c·ªßa anh <a href=\"https://www.facebook.com/dung.tavan\">T·∫° VƒÉn D≈©ng</a>, m·ªôt ng∆∞·ªùi anh senior r·∫•t t√¢m huy·∫øt v·ªõi ngh·ªÅ, c≈©ng nh∆∞ r·∫•t nhi·ªát t√¨nh trong vi·ªác gi√∫p ƒë·ª° v√† gi·∫£i ƒë√°p th·∫Øc m·∫Øc cho junior ƒëi sau (trong ƒë√≥ c√≥ m√¨nh).</p>\n<p>Anh l√† founder c·ªßa t·ªï ch·ª©c m√£ ngu·ªìn m·ªü <a href=\"https://github.com/youngmonkeys\">YoungMonkeys</a> - github, c√≥ kh√° l√† nhi·ªÅu th∆∞ vi·ªán v√† framework ƒë√£ ƒë∆∞·ª£c team implement s·∫µn, ƒë·∫∑c bi·ªát ƒë·ªëi v·ªõi c√°c startup l√†m v·ªÅ game.</p>\n<p>C√°c b·∫°n c√≥ th·ªÉ t√¨m th·∫•y pattern Object Pool n√†y ·ªü trang s·ªë 86:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/34703e229ed72bc6defb78acaa572097/9568a/sach-lamchu-design-pattern.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQCAQP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB3bJTG2hP7BwS/wD/xAAcEAABAwUAAAAAAAAAAAAAAAABABARAgMEIUH/2gAIAQEAAQUCxxADWtUS/F//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAXEAEAAwAAAAAAAAAAAAAAAAABECBR/9oACAEBAAY/Al2S3//EABoQAQACAwEAAAAAAAAAAAAAAAEAMRARIUH/2gAIAQEAAT8hEO1NiN3A1dvWC15CoccCp//aAAwDAQACAAMAAAAQXB9+/8QAFREBAQAAAAAAAAAAAAAAAAAAASD/2gAIAQMBAT8QY//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExUXFBgeH/2gAIAQEAAT8QDjWXqKx8d7j5CXsA9Wl+Qju3pJRDRk5mIGgqXeYRYT//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"338E3B68-731B-43B2-A0D6-22163A59AE46.jpeg\"\n        title=\"338E3B68-731B-43B2-A0D6-22163A59AE46.jpeg\"\n        src=\"/static/34703e229ed72bc6defb78acaa572097/e5166/sach-lamchu-design-pattern.jpg\"\n        srcset=\"/static/34703e229ed72bc6defb78acaa572097/f93b5/sach-lamchu-design-pattern.jpg 300w,\n/static/34703e229ed72bc6defb78acaa572097/b4294/sach-lamchu-design-pattern.jpg 600w,\n/static/34703e229ed72bc6defb78acaa572097/e5166/sach-lamchu-design-pattern.jpg 1200w,\n/static/34703e229ed72bc6defb78acaa572097/d9c39/sach-lamchu-design-pattern.jpg 1800w,\n/static/34703e229ed72bc6defb78acaa572097/df51d/sach-lamchu-design-pattern.jpg 2400w,\n/static/34703e229ed72bc6defb78acaa572097/9568a/sach-lamchu-design-pattern.jpg 3024w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>C√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o mua s√°ch <a href=\"https://www.trithuctrebooks.com/products/lam-chu-cac-mau-thiet-ke-kinh-dien-trong-lap-trinh-mastering-design-patterns\">·ªü ƒë√¢y</a>, m√¨nh kh√¥ng nh·∫≠n ƒë·ªìng PR n√†o c·∫£, m√¨nh ch·ªâ mu·ªën ·ªßng h·ªô anh D≈©ng th√¥i, v√¨ ph·∫ßn l·ªõn l·ª£i nhu·∫≠n c·ªßa s√°ch n√†y ƒë·ªÅu ƒë∆∞·ª£c t√°c gi·∫£ g·ª≠i t·∫∑ng ch∆∞∆°ng tr√¨nh c·∫∑p l√° y√™u th∆∞∆°ng, peace!</p>\n<h3 id=\"connection-pooling-trong-database\" style=\"position:relative;\"><a href=\"#connection-pooling-trong-database\" aria-label=\"connection pooling trong database permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Connection pooling trong database</h3>\n<p>Ahh hhh hmmm, ch√∫ng ta quay l·∫°i b√†i gi·∫£ng.</p>\n<p>Database - c∆° s·ªü d·ªØ li·ªáu c≈©ng l√† m·ªôt ph·∫ßn m·ªÅm, c≈©ng n·∫±m tr√™n m√°y ch·ªß v·∫≠t l√Ω, m√† ƒë√£ th·∫ø th√¨ n√≥ c≈©ng s·∫Ω c√≥ gi·ªõi h·∫°n v·ªÅ s·ªë l∆∞·ª£ng k·∫øt n·ªëi trong c√πng 1 th·ªùi ƒëi·ªÉm.</p>\n<p>Con s·ªë <strong>m·∫∑c ƒë·ªãnh</strong> cho s·ªë l∆∞·ª£ng connection t·ªëi ƒëa c·ªßa MySQL l√† 151.</p>\n<p>V·ªõi Postgresql th√¨ s·∫Ω l√† 100.</p>\n<p>MSSQL th√¨ kinh d·ªã h∆°n v·ªõi con s·ªë ‚Ä¶. <strong>32.767.</strong> (Ch·∫Øc do t·ªën ti·ªÅn n√™n v·∫≠y  üòÇ)</p>\n<p>Trong khu√¥n kh·ªï b√†i n√†y m√¨nh s·∫Ω ch·ªâ t·∫≠p trung ƒë√†o s√¢u v·ªõi Postgresql.</p>\n<h3 id=\"cach-implement-connection-pooling\" style=\"position:relative;\"><a href=\"#cach-implement-connection-pooling\" aria-label=\"cach implement connection pooling permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>C√°ch implement connection pooling</h3>\n<p>V·ªÅ c∆° b·∫£n ch√∫ng ta c√≥ 2 c√°ch ƒë·ªÉ implement connection pooling.</p>\n<ul>\n<li>C√°ch ƒë·∫ßu ti√™n l√† c√†i c√°c ph·∫ßn m·ªÅm, extension th√™m v√†o, ch·∫≥ng h·∫°n nh∆∞ <strong>pgbouncer.</strong></li>\n<li>C√°ch th·ª© 2, ch√≠nh l√† implement connection pooling ph√≠a layer backend.</li>\n</ul>\n<p>Ch√∫ng ta c√≥ th·ªÉ implement 1 pooler c√°ch ƒë∆°n gi·∫£n b·∫±ng c√°ch s·ª≠ d·ª•ng <em>1 Queue/ Stack</em> v√† <em>1 mutex Lock</em>, v√¨ n√≥ l√† design pattern m√†, dƒ© nhi√™n. Tham kh·∫£o tutorial c·ªßa Microsoft <a href=\"https://learn.microsoft.com/en-us/azure/mysql/single-server/sample-scripts-java-connection-pooling\">Java sample to illustrate connection pooling</a>.</p>\n<p>Tr√™n th·ª±c t·∫ø th√¨ ch√∫ng ta ch·∫≥ng ƒëi <strong>re-invent the wheel</strong> l√†m g√¨, c√°c th∆∞ vi·ªán hi·ªán t·∫°i ƒë√£ h·ªó tr·ª£ s·∫µn r·ªìi, ch·ªâ vi·ªác d√πng th√¥i. Xem ph·∫ßn ti·∫øp d∆∞·ªõi ƒë√¢y:</p>\n<h2 id=\"benchmark-connection-pooling\" style=\"position:relative;\"><a href=\"#benchmark-connection-pooling\" aria-label=\"benchmark connection pooling permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Benchmark connection pooling</h2>\n<p>Ti·∫øt h·ªçc l√≠ thuy·∫øt ƒë√£ xong, ch√∫ng ta chuy·ªÉn qua ti·∫øt th·ª±c h√†nh nh√©.</p>\n<p>ƒê·∫ßu ti√™n ƒë·ªÉ minh ch·ª©ng r·∫±ng <strong>connection pooling th·ª±c s·ª± boost performance,</strong> m√¨nh c√≥ √Ω t∆∞·ªüng nh∆∞ sau:</p>\n<p>T·∫°o m·ªôt API ƒë∆°n gi·∫£n v·ªõi 3 endpoint, v·ªõi 3 ph∆∞∆°ng ph√°p s·ª≠ d·ª•ng database connection kh√°c nhau:</p>\n<ul>\n<li>Kh·ªüi t·∫°o 1 connection m·ªõi cho m·ªçi request.</li>\n<li>Kh·ªüi t·∫°o 1 connection t·ª´ ƒë·∫ßu v√† d√πng n√≥ cho m·ªçi request (singleton).</li>\n<li>Kh·ªüi t·∫°o 1 connection pool v·ªõi s·ªë l∆∞·ª£ng idle connection cao.</li>\n</ul>\n<p>Sau ƒë√≥ s·∫Ω test 3 endpoint n√†y b·∫±ng c·∫£ browser v√† tool benchmark t·∫•n c√¥ng d·ªìn d·∫≠p üëª.</p>\n<p>ƒê·∫ßu ti√™n l√† c·∫•u h√¨nh m√°y m√¨nh:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">‚ûú  ~ neofetch\nM√°y Ki√™n ƒê·∫πp Trai\n-----------------\nOS: Ubuntu <span class=\"token number\">22.10</span> x86_64\nHost: Latitude <span class=\"token number\">5420</span>\nKernel: <span class=\"token number\">5.19</span>.0-38-generic\nCPU: 11th Gen Intel i7-1185G7 <span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> @ <span class=\"token number\">4</span>.800GHz\nGPU: Intel TigerLake-LP GT2 <span class=\"token punctuation\">[</span>Iris Xe Graphics<span class=\"token punctuation\">]</span>\nMemory: 8862MiB / 31491MiB</code></pre></div>\n<h3 id=\"m·ªôt-vai-khai-ni·ªám\" style=\"position:relative;\"><a href=\"#m%E1%BB%99t-vai-khai-ni%E1%BB%87m\" aria-label=\"m·ªôt vai khai ni·ªám permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>M·ªôt v√†i kh√°i ni·ªám</h3>\n<p>Ch√∫ng ta l√†m quen tr∆∞·ªõc v√†i kh√°i ni·ªám c·ªßa connection pooling:</p>\n<ul>\n<li><strong>Pool size</strong>: K√≠ch th∆∞·ªõc c·ªßa connection pool, dƒ© nhi√™n kh√¥ng ƒë∆∞·ª£c v∆∞·ª£t qu√° s·ªë l∆∞·ª£ng k·∫øt n·ªëi t·ªëi ƒëa c·ªßa DB r·ªìi.</li>\n<li><strong>Idle connection</strong>: C√°c connection ‚Äút·∫°m ngh·ªâ‚Äù, khi ƒë∆∞·ª£c s·ª≠ d·ª•ng xong th√¨ c√°c idle connection kh√¥ng ƒë∆∞·ª£c release lu√¥n, m√† ƒë∆∞·ª£c ·ªü l·∫°i tr·∫°ng th√°i n√†y.</li>\n<li><strong>Connection lifetime</strong>: ƒê·∫°i lo·∫°i l√† th·ªùi gian m√† c√°c connection \"live\", ƒë·∫°t ng∆∞·ª°ng n√†y th√¨ force close connection.</li>\n</ul>\n<blockquote>\n<p>üí° Kh√¥ng c√≥ g√¨ ch·∫Øc ch·∫Øn r·∫±ng c√°c ‚Äúidle connection‚Äù s·∫Ω lu√¥n lu√¥n s·ªëng v√† kh√¥ng c·∫ßn ph·∫£i handshake l·∫°i v·ªõi DB v√¨ c√°c l√≠ do nh∆∞ timeout (th·ªùi gian ƒë√£ set) ho·∫∑c do ph√≠a DB.\nDo ƒë√≥ c√≥ th·ªÉ v√†i th∆∞ vi·ªán th·ª±c hi·ªán c∆° ch·∫ø ping li√™n t·ª•c b·∫±ng c√°c idle connection ƒë·ªÉ gi·ªØ t·ª•i n√≥ lu√¥n lu√¥n kh√¥ng b·ªã close.\nDƒ© nhi√™n th√¨ l√†m v·∫≠y s·∫Ω t·ªën resource h∆°n ƒë·ªÉ qu·∫£n l√Ω.</p>\n</blockquote>\n<h3 id=\"d·ª±ng-database-postgres-va-data\" style=\"position:relative;\"><a href=\"#d%E1%BB%B1ng-database-postgres-va-data\" aria-label=\"d·ª±ng database postgres va data permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>D·ª±ng database postgres v√† data</h3>\n<p>T√≠ n·ªØa m√¨nh s·∫Ω ƒë·ªÉ repo benchmark ·ªü cu·ªëi b√†i vi·∫øt<sup id=\"fnref-2\"><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup> cho n√™n code m·∫´u m√¨nh tr√¨nh b√†y s·∫Ω ƒë·∫°i kh√°i d∆∞·ªõi d·∫°ng pseudo.</p>\n<p>B·∫°n n√†o t√≤ m√≤ mu·ªën th·ª≠ c√≥ th·ªÉ clone v·ªÅ th·ª≠, nh∆∞ng m√¨nh v·∫´n s·∫Ω h∆∞·ªõng d·∫´n t·ª´ng b∆∞·ªõc m√¨nh l√†m c√°i benchmark n√†y nh√©.</p>\n<p>ƒê·ªÉ chu·∫©n b·ªã data cho b√†i test th√¨ m√¨nh t·∫°o 1 table <strong>products</strong> nh∆∞ sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">IF</span> <span class=\"token operator\">NOT</span> <span class=\"token keyword\">EXISTS</span> products <span class=\"token punctuation\">(</span>\n    id <span class=\"token keyword\">SERIAL</span> <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span><span class=\"token punctuation\">,</span>\n    name <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n    price <span class=\"token keyword\">NUMERIC</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n    description <span class=\"token keyword\">TEXT</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Sau ƒë√≥ l√™n <a href=\"https://mockaroo.com/\">mockaroo</a> ƒë·ªÉ t·∫°o 1000 d√≤ng data:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/418d5a0de17d85ba489bb2357503d3e2/d4377/mockaroo-mock-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyklEQVQoz4WRyQ6EMAxD+f8fBQlKWbqwHDJ6kVzNMAcOVuI2cZy2u67LzvM04n3fLQpP/obuOA5b19VSSt5MzDl7Xmuxbdus1mrUMfgN3b7v3kQDiDHa0Pe2p+TnYJ5nW5blZwvhyTscTdPUXMwh2DiOxqBvaChRWwDxJphzcgesLYdw7EuslOIOqYGTu/MYXZS+JggJIdgwDF6EEG6fb6MN9Ik6k1B7Q4qYim25EZiunGKi6iT29ykIUgRBgBzQrE9BQPc605Cn4AccJm0dv5oUqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Mock product mockaroo\"\n        title=\"Mock product mockaroo\"\n        src=\"/static/418d5a0de17d85ba489bb2357503d3e2/c1b63/mockaroo-mock-data.png\"\n        srcset=\"/static/418d5a0de17d85ba489bb2357503d3e2/5a46d/mockaroo-mock-data.png 300w,\n/static/418d5a0de17d85ba489bb2357503d3e2/0a47e/mockaroo-mock-data.png 600w,\n/static/418d5a0de17d85ba489bb2357503d3e2/c1b63/mockaroo-mock-data.png 1200w,\n/static/418d5a0de17d85ba489bb2357503d3e2/d4377/mockaroo-mock-data.png 1294w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Sau khi download v·ªÅ, m√¨nh c√≥ copy paste l·∫°i 1000 d√≤ng th√†nh h∆°n m·∫•y ch·ª•c ngh√¨n d√≤ng d·ªØ li·ªáu.</p>\n<p>ƒê·ªÉ t·∫°o 1 database postgres tr√™n m√°y, c√°ch nhanh nh·∫•t l√† m√¨nh d√πng docker:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.9\"</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">postgres</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> postgres<span class=\"token punctuation\">:</span>13.1<span class=\"token punctuation\">-</span>alpine\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> postgres_container\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./seed.sql<span class=\"token punctuation\">:</span>/docker<span class=\"token punctuation\">-</span>entrypoint<span class=\"token punctuation\">-</span>initdb.d/seed.sql\n      <span class=\"token punctuation\">-</span> ./data/postgres<span class=\"token punctuation\">:</span>/var/lib/postgresql/data\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> POSTGRES_DB=$<span class=\"token punctuation\">{</span>POSTGRES_DB<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>postgres<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">-</span> POSTGRES_USER=$<span class=\"token punctuation\">{</span>POSTGRES_USER<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>postgres<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">-</span> POSTGRES_PASSWORD=$<span class=\"token punctuation\">{</span>POSTGRES_PASSWORD<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>password1<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"5433:5432\"</span>\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> unless<span class=\"token punctuation\">-</span>stopped</code></pre></div>\n<p>Theo k·∫ø ho·∫°ch th√¨ nh·ªØng b√†i ti·∫øp theo c·ªßa series n√†y, m√¨nh s·∫Ω n√≥i v·ªÅ docker, n·∫øu b·∫°n ch∆∞a hi·ªÉu docker l√† g√¨, th√¨ ƒë√≥n ƒë·ªçc nh·ªØng b√†i ti·∫øp theo nh√©. Ph·∫ßn hi·ªán t·∫°i b·∫°n ch·ªâ c·∫ßn bi·∫øt n√≥ l√† c√¥ng c·ª• ƒë·ªÉ m√¨nh t·∫°o 1 database postgres l√† ƒë∆∞·ª£c.</p>\n<p>Okay, ch·∫°y d√≤ng l·ªánh <code class=\"language-text\">docker compose up -d</code> ƒë·ªÉ c√≥ 1 database c√≥ s·∫µn data. DB n√†y c√≥ port 5433, username v√† password nh∆∞ file yaml. (Ch·ªçn port 5433 t·∫°i v√¨ s·ª£ n√≥ conflict v·ªõi DB c√≥ s·∫µn tr√™n m√°y m√¨nh th√¥i)</p>\n<p>Chuy·ªÉn qua ph·∫ßn ti·∫øp theo</p>\n<h3 id=\"d·ª±ng-api-b·∫±ng-go\" style=\"position:relative;\"><a href=\"#d%E1%BB%B1ng-api-b%E1%BA%B1ng-go\" aria-label=\"d·ª±ng api b·∫±ng go permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>D·ª±ng API b·∫±ng Go</h3>\n<p>M√¨nh ƒëang code Go, cho n√™n m√¨nh s·∫Ω ch·ªçn Go ƒë·ªÉ l√†m API cho v√≠ d·ª• benchmark (s·ª≠ d·ª•ng Gin framework, 1 framework nh·∫π v√† m·∫°nh m·∫Ω).</p>\n<p>T∆∞∆°ng t·ª± v·ªõi DDL products b√™n tr√™n, m√¨nh c√≥ model Product:</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> Product <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tID          <span class=\"token builtin\">int</span>     <span class=\"token string\">`json:\"id\"`</span>\n\tName        <span class=\"token builtin\">string</span>  <span class=\"token string\">`json:\"name\"`</span>\n\tPrice       <span class=\"token builtin\">float64</span> <span class=\"token string\">`json:\"price\"`</span>\n\tDescription <span class=\"token builtin\">string</span>  <span class=\"token string\">`json:\"description\"`</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>T∆∞∆°ng t·ª± t·∫°o 1 model response c·ªßa API, c√≥ ch·ª©a th√™m 2 field ƒë·ªÉ m√¨nh estimate th·ªùi gian c·ªßa request:</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> Response <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tElapsed  <span class=\"token builtin\">int64</span>      <span class=\"token string\">`json:\"elapsed\"`</span>\n\tAverage  <span class=\"token builtin\">float64</span>    <span class=\"token string\">`json:\"average\"`</span>\n\tProducts <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span>Product <span class=\"token string\">`json:\"products\"`</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>K·∫ø ti·∫øp, khai b√°o query ƒë·ªÉ select 1000 product t·ª´ DB c≈©ng nh∆∞ connection string cho DB.</p>\n<p>Sau ƒë√≥ n·ªØa, t·∫°o 1 connection Pool, 1 singleton connection ƒë·ªÉ d√πng cho 3 endpoint nh∆∞ idea m√¨nh ƒë√£ n√™u ph√≠a tr√™n:</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">var</span> dsn <span class=\"token operator\">=</span> <span class=\"token string\">\"postgres://postgres:password1@localhost:5433/postgres?sslmode=disable\"</span>\n<span class=\"token keyword\">var</span> query <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT id, name, price, description FROM products limit 1000\"</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// Postgres allows 100 connections in default</span>\n\t<span class=\"token comment\">// Set the maximum number of idle connections in the pool</span>\n\tidleConn <span class=\"token operator\">:=</span> <span class=\"token number\">50</span>\n\t<span class=\"token comment\">// Set the maximum number of connections in the pool</span>\n\tmaxConnections <span class=\"token operator\">:=</span> <span class=\"token number\">90</span>\n\t<span class=\"token comment\">// Set the maximum amount of time a connection can be reused</span>\n\tmaxConnLifetime <span class=\"token operator\">:=</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> time<span class=\"token punctuation\">.</span>Minute\n\tpoolConn<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> sqlx<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">,</span> dsn<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\tlog<span class=\"token punctuation\">.</span><span class=\"token function\">Fatalf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Unable to connect to database: %v\\n\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">defer</span> poolConn<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\tpoolConn<span class=\"token punctuation\">.</span><span class=\"token function\">SetMaxOpenConns</span><span class=\"token punctuation\">(</span>maxConnections<span class=\"token punctuation\">)</span>\n\tpoolConn<span class=\"token punctuation\">.</span><span class=\"token function\">SetMaxIdleConns</span><span class=\"token punctuation\">(</span>idleConn<span class=\"token punctuation\">)</span>\n\tpoolConn<span class=\"token punctuation\">.</span><span class=\"token function\">SetConnMaxLifetime</span><span class=\"token punctuation\">(</span>maxConnLifetime<span class=\"token punctuation\">)</span>\n\n\t<span class=\"token comment\">// normal connection</span>\n\tconn<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> sqlx<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">,</span> dsn<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\tlog<span class=\"token punctuation\">.</span><span class=\"token function\">Fatalf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Unable to connect to database: %v\\n\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token comment\">// default will be 2 idle connections</span>\n\t<span class=\"token comment\">// so set it to 1 to simulate</span>\n\tconn<span class=\"token punctuation\">.</span><span class=\"token function\">SetMaxIdleConns</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n\t<span class=\"token comment\">// Initialize the HTTP router</span>\n\trouter <span class=\"token operator\">:=</span> gin<span class=\"token punctuation\">.</span><span class=\"token function\">Default</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\trouter<span class=\"token punctuation\">.</span><span class=\"token function\">StaticFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"./index.html\"</span><span class=\"token punctuation\">)</span>\n\n\t<span class=\"token comment\">// Handlers...</span>\n\n\t<span class=\"token comment\">// Start the HTTP server</span>\n\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">:=</span> router<span class=\"token punctuation\">.</span><span class=\"token function\">Run</span><span class=\"token punctuation\">(</span><span class=\"token string\">\":8080\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\tlog<span class=\"token punctuation\">.</span><span class=\"token function\">Fatalf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Unable to start HTTP server: %v\\n\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>·ªû ƒë√¢y m√¨nh ch·ªçn th∆∞ vi·ªán <code class=\"language-text\">sqlx</code>, th∆∞ vi·ªán n√†y n·∫øu ch√∫ng ta t·∫°o 1 connection singleton, th√¨ m·∫∑c ƒë·ªãnh n√≥ ƒë√£ b·∫≠t ch·∫ø ƒë·ªô connection pool r·ªìi, do ƒë√≥ m√¨nh set s·ªë l∆∞·ª£ng v·ªÅ 1 ƒë·ªÉ gi·∫£ l·∫≠p t√¨nh tr·∫°ng kh√¥ng c√≥ pool ·ªü c√°c ng√¥n ng·ªØ v√† th∆∞ vi·ªán kh√°c.</p>\n<p>V·ªÅ ph·∫ßn pool, m√¨nh c√†i ƒë·∫∑t pool size l√† 90, v√† s·ªë l∆∞·ª£ng idle connection l√† 50, m·ªôt con s·ªë kh√° l·ªõn, v√† lifetime l√† 2 ph√∫t.</p>\n<p>R·ªìi, ch√∫ng ta th√™m 3 endpoint v·ªõi method <code class=\"language-text\">GET</code>:</p>\n<ul>\n<li><code class=\"language-text\">products/pooled</code> : S·ª≠ d·ª•ng <strong>connection pool</strong>.</li>\n<li><code class=\"language-text\">products/normal</code> : S·ª≠ d·ª•ng m·ªôt <strong>singleton connection</strong> cho to√†n b·ªô request.</li>\n<li><code class=\"language-text\">products/new</code>: Th√†nh l·∫≠p <strong>1 k·∫øt n·ªëi m·ªõi</strong> cho m·ªçi request.</li>\n</ul>\n<p>B·∫°n c√≥ th·ªÉ th·∫•y, behavior c·ªßa 3 endpoint n√†y gi·ªëng nhau ho√†n to√†n, tr·ª´ vi·ªác s·ª≠ d·ª•ng connection t·ªõi database th√¥i.</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\">router<span class=\"token punctuation\">.</span><span class=\"token function\">GET</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/products/normal\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">*</span>gin<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\tstartTime <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\t\t<span class=\"token comment\">// Query the database for all products</span>\n\t\trows<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">Query</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">JSON</span><span class=\"token punctuation\">(</span>http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">,</span> gin<span class=\"token punctuation\">.</span>H<span class=\"token punctuation\">{</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">:</span> err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token keyword\">return</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\tproducts<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> <span class=\"token function\">scanProducts</span><span class=\"token punctuation\">(</span>rows<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">JSON</span><span class=\"token punctuation\">(</span>http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">,</span> gin<span class=\"token punctuation\">.</span>H<span class=\"token punctuation\">{</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">:</span> err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token keyword\">return</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\telapsed <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Since</span><span class=\"token punctuation\">(</span>startTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Microseconds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\tallCount<span class=\"token operator\">++</span>\n\t\tallTime <span class=\"token operator\">+=</span> elapsed\n\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">JSON</span><span class=\"token punctuation\">(</span>http<span class=\"token punctuation\">.</span>StatusOK<span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>Response<span class=\"token punctuation\">{</span>Elapsed<span class=\"token punctuation\">:</span> elapsed<span class=\"token punctuation\">,</span> Average<span class=\"token punctuation\">:</span> <span class=\"token function\">float64</span><span class=\"token punctuation\">(</span>allTime <span class=\"token operator\">/</span> allCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> Products<span class=\"token punctuation\">:</span> products<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">GET</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/products/pooled\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">*</span>gin<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\tstartTime <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token comment\">// Query the database for all products</span>\n\t\trows<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> poolConn<span class=\"token punctuation\">.</span><span class=\"token function\">Query</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">JSON</span><span class=\"token punctuation\">(</span>http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">,</span> gin<span class=\"token punctuation\">.</span>H<span class=\"token punctuation\">{</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">:</span> err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token keyword\">return</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\tproducts<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> <span class=\"token function\">scanProducts</span><span class=\"token punctuation\">(</span>rows<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">JSON</span><span class=\"token punctuation\">(</span>http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">,</span> gin<span class=\"token punctuation\">.</span>H<span class=\"token punctuation\">{</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">:</span> err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token keyword\">return</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\telapsed <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Since</span><span class=\"token punctuation\">(</span>startTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Microseconds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\tpoolCount<span class=\"token operator\">++</span>\n\t\tpoolTime <span class=\"token operator\">+=</span> elapsed\n\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">JSON</span><span class=\"token punctuation\">(</span>http<span class=\"token punctuation\">.</span>StatusOK<span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>Response<span class=\"token punctuation\">{</span>Elapsed<span class=\"token punctuation\">:</span> elapsed<span class=\"token punctuation\">,</span> Average<span class=\"token punctuation\">:</span> <span class=\"token function\">float64</span><span class=\"token punctuation\">(</span>poolTime <span class=\"token operator\">/</span> poolCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> Products<span class=\"token punctuation\">:</span> products<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">GET</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/products/new\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">*</span>gin<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\tstartTime <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\tconn<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> sqlx<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">,</span> dsn<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\t\tlog<span class=\"token punctuation\">.</span><span class=\"token function\">Fatalf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Unable to connect to database: %v\\n\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">}</span>\n\n\t\trows<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">Query</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">JSON</span><span class=\"token punctuation\">(</span>http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">,</span> gin<span class=\"token punctuation\">.</span>H<span class=\"token punctuation\">{</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">:</span> err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token keyword\">return</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\tproducts<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> <span class=\"token function\">scanProducts</span><span class=\"token punctuation\">(</span>rows<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n\t\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">JSON</span><span class=\"token punctuation\">(</span>http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">,</span> gin<span class=\"token punctuation\">.</span>H<span class=\"token punctuation\">{</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">:</span> err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token keyword\">return</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\telapsed <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Since</span><span class=\"token punctuation\">(</span>startTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Microseconds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\tnewCount<span class=\"token operator\">++</span>\n\t\tnewTime <span class=\"token operator\">+=</span> elapsed\n\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">JSON</span><span class=\"token punctuation\">(</span>http<span class=\"token punctuation\">.</span>StatusOK<span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>Response<span class=\"token punctuation\">{</span>Elapsed<span class=\"token punctuation\">:</span> elapsed<span class=\"token punctuation\">,</span> Average<span class=\"token punctuation\">:</span> <span class=\"token function\">float64</span><span class=\"token punctuation\">(</span>newTime <span class=\"token operator\">/</span> newCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> Products<span class=\"token punctuation\">:</span> products<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Xong ph√≠a backend, qua code ch√∫t HTML ƒë·ªÉ test ph√≠a browser n√†o:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>getProducts('normal')<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Get Products<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>getProducts('new')<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Get Products | New<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>getProducts('pooled')<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    Get Products | Connection Pool\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n    <span class=\"token keyword\">function</span> <span class=\"token function\">getProducts</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mode</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> lastResult <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> promises <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">200</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        promises<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>\n          <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/products/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>mode<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> elapsed<span class=\"token punctuation\">,</span> average<span class=\"token punctuation\">,</span> products <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n              lastResult <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> elapsed<span class=\"token punctuation\">,</span> average <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n              console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> elapsed<span class=\"token punctuation\">,</span> average <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      Promise<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span>promises<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Last result for </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>mode<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">:</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> lastResult<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Code n√†y r·∫•t ƒë∆°n gi·∫£n, v·ªõi m·ªói l·∫ßn nh·∫•n button, th√¨ m√¨nh s·∫Ω d√πng promise ch·∫°y b·∫•t ƒë·ªìng b·ªô 200 request t·ªõi endpoint t∆∞∆°ng ·ª©ng.</p>\n<h3 id=\"k·∫øt-qu·∫£-test-benchmark\" style=\"position:relative;\"><a href=\"#k%E1%BA%BFt-qu%E1%BA%A3-test-benchmark\" aria-label=\"k·∫øt qu·∫£ test benchmark permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>K·∫øt qu·∫£ test benchmark</h3>\n<p>B·∫•m ch·∫°y ch∆∞∆°ng tr√¨nh, v√† ch√∫ng ta c√≥ 3 button v·ªõi response c·ªßa m·ªói request c√≥ 1000 product, response n·∫∑ng kho·∫£ng <strong>86.53</strong> KB.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1066px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/68d364d0b3c080e5d0f3aaa6b793bfd2/2e367/browser-test-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAADz0lEQVQ4y5WT3WsdRRjG948QtGg1WAt6p6AognRvilB762VvvFL0xlv/A6lbogSLhhZEUNIkFdukmMSkTRObk5ycNjn9SDXfabPn7J7d2Z2d3ZnZmd15ZDfB1gsvHPjxzrzM+/DO8LzWuy+eGXjnpc/wVt/HeP3oR3iz71O88fIZvHLkFPqeef8/Of7saRx/7hReff4DvHbkQ7z9wud47+gnA9b01PzZZuMuGrdWRGNhRbdaa3p1ZV3faa3r5uKabi4+PGTtX3G5+VAvLtzVzcYD3VhYEUuLbUxOzJ+1uMgcHCwFwOD/L3NYCyEyx+r5PceUBlprhRKgguFie7Tmx/tXMLg6gsHVYfz0YAyDq5fq/YX2CM7f+Rlu4tdyVW2lUWlZhJCnO4SBQSAihDIGkRGIJAjrSP/JhyJGTxBoU+DpWkJCx3LdjiOlBOdcZVkGzgWUVMi5RMoByoFc6PqsZRVz6FzXd6SQUEpXqDzP4XmeY7Xb95xeGKHrB4pEFBURTUAIQZgIhEyBZRyMMfAsRRgGCIIA3a4H3++BsRSERCqOY2xsbDiWu7vh6CwCJFUwElAMmicIQoIwDBGREEnC6s6DtARheS1e5WJKkSsFmeeqKEp0ul3H+uKXSeeb6x30T/dU/2yCL6dCjLZCZJSAJQz1N2QZsjQFyxQyntdnzg/yWmsUWiutFLxKcGD6mjP9wMON+6Fa2Ba4+VeC1ibBlsfgUgqRF+CqBNclhC4gVIUBz8uaLC+QCq0ixrGz5zrW/Nq0w5IeVFo9WQM6w67P8PUcx1ezAb5vZLgwl+LCHMPFmwyDf2Ton4vx7a0M55+gvluUcCb2Heu3lQnH9TvwvJ4SUiGKE1BK4ScKa12FPwOBcDMFX6Ng9xKsuwm2Ix9SAVIbiApVqrwAXC9wrCutX519z61MqWSuENMELKEIUo3NQGGXCrBHHHqTQW6mCPZTuDQClRmMOfCtMab2YRCGjjV2+6qz7+3D9/xK0MQxNZTGxmfabATK7MTSxI+4ETupEVupCR8Ls02ICTgzeQGTF8bIwihlgE4vcKzJ9oTTIz1EJFZKFybNuOFZaigvzV6kjcuk4R1pyj1uWJebKGKG59qoUpvDOTZPJoU41uzt2XP7HRfdTreMY4qu54OEAbxYYMMT2AopensJ8vUI4Q7D444HQlMkIq38B6VU5cVS66KalHPW5aHLx65eGTs5NHTpxPj4NXtoaNgeuzpmT84u2CMTDXt46ro9MTZnN4ev27+Pzts/3Bi3byzM2Kuttt1sLtlLSzUnlpeXT87MzBz7G3CUo1GzzSFSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Trang chu api\"\n        title=\"Trang chu api\"\n        src=\"/static/68d364d0b3c080e5d0f3aaa6b793bfd2/2e367/browser-test-1.png\"\n        srcset=\"/static/68d364d0b3c080e5d0f3aaa6b793bfd2/5a46d/browser-test-1.png 300w,\n/static/68d364d0b3c080e5d0f3aaa6b793bfd2/0a47e/browser-test-1.png 600w,\n/static/68d364d0b3c080e5d0f3aaa6b793bfd2/2e367/browser-test-1.png 1066w\"\n        sizes=\"(max-width: 1066px) 100vw, 1066px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>ƒê·ªÉ duy tr√¨ t√≠nh ·ªïn ƒë·ªãnh cho b√†i test, m·ªói l·∫ßn ch·∫°y benchmark 1 endpoint, m√¨nh s·∫Ω restart app ƒë·ªÉ app reset l·∫°i connection pool.</p>\n<p>ƒê·∫ßu ti√™n ch√∫ng ta th·ª≠ v·ªõi endpoint <code class=\"language-text\">/products/new</code> , n∆°i m√† connection s·∫Ω ƒë∆∞·ª£c t·∫°o m·ªõi l·∫°i 200 l·∫ßn, sau khi b·∫•m n√∫t, th√¨ sau ch∆∞a t·ªõi 100 request ƒë√£ b·ªã l·ªói:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1066px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d2434b81f25fb3fde41924f4a481ed99/2e367/browser-2-new.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAADaklEQVQ4y5XRTY/bRBgHcH8IJKigsKJUghtIIBAS6l4qpMKVYy+cQHDhc1TuqRKHAicEEoUL4kBB7VJU2N0m2Zdkk+zmZWPHsWPH8cTvM57xzB/FWUpW0AMj/TSPNPP8NS/a289fv/XWC5/ijY2P8OrFD/H6xid47cXreOnCNWw89e4TXX76fVx+5hpefvY9vHLhA7z53Gd45+LHt7R7vz68UdtpYefPA7qzfSAaja44POiL/UZf1Ha7orZ7fKZ7bq7XjsXudkvUdjpiZ/uAPtpt4pe7D29oOc10rAYHoPD/hzrrBaWZrvkzX1dSQQjBlQQimuCr5g+Vr9s/4ovDO5VvOj/h9uF3uH14B182v8fn+9/CiWdV3KpXYZmlEULWTwhAIqALBCz8Bw1BWASfEsyXazSsaiFLrPcGQaBrjjPVKWPI84yTVICkEgXlKHIGTvkKW1FCQjAOyUsIJlAUHCzNwPKcc87heZ6uHR219cUihO/7PIgYSFoiSlIQQhDHCaI4RpplcF0PljXByDAwsW0Yhomp6yLyA/jejAdkgZOTnq55rquTTMCLS+7FDCRfYJYo+NnySvLxy0spURRFRXCB5YlKIUCSAuY05k7A0Bu7ukaCue6nJexIcXNB4SQ+rIWEFXkoSgEoBbX0hC8OogJDO+FWwDGwg+Uvz/R5XMANBbdJDjf2YRMON5qBi7NAKc+RZVm9o+IlSEhhOjGfBgxDa6ZrtmHqljnF3A743AkQTiYIxh4C20M2J+AphaIF5BoehSgMgmJEELo+PHPGA4fAHJi6Njru6cOjLqKByZPRBEnvFFF3gKhvgDoeRJxBnpODTh1ku2OkfxhITBPx6YRnpgO7faJrg1ZHP6nvIen2edYfIen0EDW71cwmbhVShsljMkyRWSaSewPEP/eQng6RDQxOT8dwmm1dGxwtA/cRrwJV3O6pqNlVcaen2MRVMs5UGSZrUpVZY5XcH6j4bk8lw6FK+wbP/w4cdU70/n4TaX/E6chSy9D0eKCyvqGKqV8Fyihdkynq2Cr9faTS+6cqH48VNSacjR3Yra6uWeb4ZhonKHIqC8qwQlGwtfo/sCgDi/JqH6dMspziqN29qW09eHCp2WpdrTUaV2qN+uZKY/N8/W/15l6lVq9vPmrUrzT29q5u/bZ16S/Rqa0pN4iUDQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"API NEW\"\n        title=\"API NEW\"\n        src=\"/static/d2434b81f25fb3fde41924f4a481ed99/2e367/browser-2-new.png\"\n        srcset=\"/static/d2434b81f25fb3fde41924f4a481ed99/5a46d/browser-2-new.png 300w,\n/static/d2434b81f25fb3fde41924f4a481ed99/0a47e/browser-2-new.png 600w,\n/static/d2434b81f25fb3fde41924f4a481ed99/2e367/browser-2-new.png 1066w\"\n        sizes=\"(max-width: 1066px) 100vw, 1066px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>ƒê√¢y ch√≠nh l√† error message:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">error\t<span class=\"token string\">\"pq: sorry, too many clients already\"</span></code></pre></div>\n<p>ƒê·∫•y, ch∆∞a g√¨ m·ªõi v·∫≠y th√¥i m√† DB ƒë√£ ch·ª≠i r·ªìi.</p>\n<p>Th·ªùi gian trung b√¨nh c·ªßa request ·ªü endpoint n√†y l√† kho·∫£ng: <strong>6380</strong> micro seconds ~ <strong>6.3ms</strong></p>\n<p>Ti·∫øp t·ª•c v·ªõi n√∫t normal, n∆°i m√† s·ª≠ d·ª•ng singleton connection cho m·ªçi request, <code class=\"language-text\">/products/normal</code>:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1066px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a912421d941e99588b708218ad22d071/2e367/browser-3-normal.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAADAUlEQVQ4y52ST4scRRiH+0MENGh0MQb0pqAYBElfghBz9ZiLJyW5+DlC5xTwEPUkCkYv4kUlLITgzk7vzPTsJrvZBJNZd6b/bHdXT1dXd3VVddVPumfc7ErExBceuujq9+H3VrX1/iuXrp999QreXfkUb536BO+sXMbbr13C6ycvYOXEh//KmRcu4syLF/DGSx/hzZMf472XP8cHpz67bt367c5Vt7eF3u8e7615ajDYUWPvoRoNHip3fUe56/eX7Bx7brj31fralnJ726q35vH++iZ+/eXOVavipYNFSQAGz19m2QvOS8eKD2LHaAOllDQayHmBrzd/7Pjm3k/4cnyz49vtn3Fj/D1ujG/iq80f8MXoO/j0oNMteg1al0UIOZoQgEbKM6T1/Al8DlLniDlB0u7xebdWpvk7Ytebpqlj+X7g1HWNqiolYQqEaQguIaoakssF9QKjNFQtoWWDRiiIWkBK1SWUUiKKIse6e/eek2XzNq5Mco5WmlMGQggoLZBTClaWCMMI+/tTPJ5MMJ3NMNnbQxAEoEX7bSbTlGB394FjRWHokLJBRLWMaA3CM0SFQVxlaNpDXZbWGkKIDqUU2kRNo0BojYlPpU9qPPgzdCySJk5aNgiplrN5jYilmM0bhEUM2TSAMTBLnlYZFdgLmfQziUd+6lhJEh8K/bzGASMI8laYLIU4FP6TdpMcEf4xS44L24QhixHkGj5NIJR8NmHApE+WwjSJuzPshPliZD9vEP3fhEeFi5HTbmSfxhCN+k9h9jRhWmqE1MhZLkzIDkxItfFpbGSjFl3dzbSO49W+J1SYVhi0l7IQJg4pBMK5kH5WmpDGJqTGzPLcMMmN0o2plTaykUv5cVrhJGBySiR29xPHmk6n16qyBGNMs6IAKyswLlBUEkVVdeRljZKXEEJ2/99RyqoGLbjOGYe3vXvNWl1dPe2Nx+eHo9E5z/Ps0WhoewPX9oZ92xsMO8bDDXs0GNmu27dd1z2k33ft4WDDHnuDc1ve8Pzt1Vun/wIHDL1fwZ8mbwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"API normal\"\n        title=\"API normal\"\n        src=\"/static/a912421d941e99588b708218ad22d071/2e367/browser-3-normal.png\"\n        srcset=\"/static/a912421d941e99588b708218ad22d071/5a46d/browser-3-normal.png 300w,\n/static/a912421d941e99588b708218ad22d071/0a47e/browser-3-normal.png 600w,\n/static/a912421d941e99588b708218ad22d071/2e367/browser-3-normal.png 1066w\"\n        sizes=\"(max-width: 1066px) 100vw, 1066px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Okay, ngon ngh·∫ª kh√¥ng b·ªã l·ªói request n√†o h·∫øt.</p>\n<p>Th·ªùi gian request trung b√¨nh l√†: 5704 micro seconds ~ 5.7ms</p>\n<p>Ch√∫ng ta t·ªõi v·ªõi tr√πm cu·ªëi <code class=\"language-text\">/products/pooled</code>:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1066px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/afb480db3839bd5243569e986a48e468/2e367/browser-4-pooling.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC/0lEQVQ4y52S0YvcRBzH80cIWrR6WAv1TUFRBGleilB99bEvPin64t9R0qeCD1WfRMHqi/iiUg5K8fY23d3krr3rtah73m42u0kmyWQmk8xk5ivJrtdbrVT9wYcZZvh95svMWG88e+nq6899hFc33sdLp9/DKxsf4uXnL+GFUxex8cRb/8jZJ9/B2acu4tzTb+PFU+/itWc+xpunP7hq3fjp1mW3t4vez57obXlqMNhXvvdAjQYPlLu9r9zteyv218bb7j21vbWr3N6e6m15or+9gx9/uHXZKgV3sCwJwOC/l1n1QgjuWNEicow2UEpJo4FcFPh859uOL+5+h0/96x1f7n2Pa/7XuOZfx2c73+CT0VcI6KLTLXsNWpdFCDmZEIBGIlIkVfYQkYFUOSJBELd7IuvmyjR/Rux6kyRxrCCYOVVVoSy5JEyBMI1aSNRlBSnkkmqJURqqktCyQVMr1FUNKVWXUEqJ+XzuWHfu3HXSNGvjyjgXaKU5ZUgIAaUFckrBOEcYznF0NMFv4zEm0ynGh4eYzWagBQMhqUwSgoOD+441D0OH8AZzquWcVshEgZA2ICKFPvFEWmvUdd2hlEKbqGkUCK0wDqgMSIX7v4eORZLYSXiDkGo5yQQWLMckk4hYBNUYGPOQR1VKaxyGTAapxK9B4lhxHB0Lg7xCzDMEeYM5iyEbDZh16foBBuSE8Jdp/HdhxNOlsIggm+bfCWdMBmQlTOKou8NWOM0rLFh6nFD9n4Rrwkwg4jmmmUK0EprHCNNHCROuEVIjp3ltFjw1QdaYBYuM0nrZ1cVsHevVrhNam1Y4ax9lKYwdUtQIs1pOCTOLIjVBbsysyEwpayMbbSqljdRqJV+nFY5nTE6IxMFR7FiTyeRKyTkYY7poPzHjYKJGUUoUZYmiFKBcgAve/b2/wssKtBA6ZwLe3sEVa3Nz84zn+xeGo9F5z/ft0WhoewPX9oZ92xu284HtDwf2aDC0+27fdl33mH7ftYeD27bvDc7vesMLNzdvnPkDiHy9pCkmfWgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"API Pooling\"\n        title=\"API Pooling\"\n        src=\"/static/afb480db3839bd5243569e986a48e468/2e367/browser-4-pooling.png\"\n        srcset=\"/static/afb480db3839bd5243569e986a48e468/5a46d/browser-4-pooling.png 300w,\n/static/afb480db3839bd5243569e986a48e468/0a47e/browser-4-pooling.png 600w,\n/static/afb480db3839bd5243569e986a48e468/2e367/browser-4-pooling.png 1066w\"\n        sizes=\"(max-width: 1066px) 100vw, 1066px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Kinh ch∆∞a? Kh√¥ng fail l·∫ßn n√†o.</p>\n<p>Con s·ªë ·∫•n t∆∞·ª£ng: 1034 microseconds ~ <strong>1.03ms</strong></p>\n<h3 id=\"benchmark-hardcore-h∆°n\" style=\"position:relative;\"><a href=\"#benchmark-hardcore-h%C6%A1n\" aria-label=\"benchmark hardcore h∆°n permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Benchmark hardcore h∆°n</h3>\n<p>B·∫°n c√≥ th·ªÉ th·∫•y con s·ªë kh√° ·∫•n t∆∞·ª£ng c·ªßa connection pool khi ch√∫ng ta ch·∫°y d·ªìn d·∫≠p 200 request b·∫±ng javascript. Tuy nhi√™n ƒë·ªÉ gi·∫£ l·∫≠p t√¨nh hu·ªëng th·ª±c t·∫ø l√∫c server nh·∫≠n h√†ng ng√†n concurrent request, m√¨nh s·∫Ω s·ª≠ d·ª•ng 1 c√¥ng c·ª• kh√°c ƒë·ªÉ benchmark: go-wrk.</p>\n<p>C√¥ng c·ª• n√†y gi√∫p benchmark / stress test m·∫°nh m·∫Ω h∆°n, h·ªó tr·ª£ config th·ªùi gian ch·∫°y bench, s·ªë goroutine ch·∫°y ƒë·ªìng th·ªùi, con s·ªë n√†y t·ªâ l·ªá thu·∫≠n v·ªõi s·ªë l∆∞·ª£ng request c√πng g·ª≠i ƒëi trong 1 th·ªùi ƒëi·ªÉm.</p>\n<p>C√†i ƒë·∫∑t:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">go <span class=\"token function\">install</span> github.com/tsliwowicz/go-wrk@latest</code></pre></div>\n<p>Command benchmark c√≥ d·∫°ng: <code class=\"language-text\">go-wrk -c &lt;s·ªë goroutine&gt; -d &lt;s·ªë gi√¢y&gt; &lt;url&gt;</code> . M·∫∑c ƒë·ªãnh s·∫Ω ch·∫°y 10 gi√¢y.</p>\n<p>Config ƒë·∫ßu ti√™n c·ªßa m√¨nh: Ch·∫°y trong v√≤ng <strong>10 gi√¢y</strong>, v·ªõi <strong>20 goroutine</strong> (b·∫°n c√≥ th·ªÉ t·∫°m hi·ªÉu goroutine l√† 1 thread).</p>\n<p><strong>Test endpoint <code class=\"language-text\">/products/new</code></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token number\">100</span> requests <span class=\"token keyword\">in</span> <span class=\"token number\">185</span>.685138ms, <span class=\"token number\">8</span>.46MB <span class=\"token builtin class-name\">read</span>\nRequests/sec:           <span class=\"token number\">538.55</span>\nTransfer/sec:           <span class=\"token number\">45</span>.56MB\nAvg Req Time:           <span class=\"token number\">37</span>.137027ms\nFastest Request:        <span class=\"token number\">12</span>.724131ms\nSlowest Request:        <span class=\"token number\">58</span>.512859ms\nNumber of Errors:       <span class=\"token number\">29433</span></code></pre></div>\n<p>Theo k·∫øt qu·∫£ b·∫°n c√≥ th·ªÉ th·∫•y ngo√†i t·ªëc ƒë·ªô ph·∫£n h·ªìi b·ªã tƒÉng ƒë√°ng k·ªÉ t·ªõi m·ª©c 37ms, v√† s·ªë l∆∞·ª£ng request b·ªã fail do h·∫øt connection c≈©ng t·ªõi g·∫ßn 30k. H·∫ßu nh∆∞ ch·ªâ c√≥ th·ªÉ x·ª≠ l√Ω ƒë∆∞·ª£c 100 request, ngang b·∫±ng s·ªë l∆∞·ª£ng connection t·ªëi ƒëa m·∫∑c ƒë·ªãnh c·ªßa DB.</p>\n<p>Okay, reset l·∫°i app v√† test endpoint ti·∫øp theo.</p>\n<p><strong>Test endpoint <code class=\"language-text\">/products/normal</code></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Running 10s <span class=\"token builtin class-name\">test</span> @ http://localhost:8080/products/normal\n  <span class=\"token number\">20</span> goroutine<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> running concurrently\n<span class=\"token number\">9358</span> requests <span class=\"token keyword\">in</span> <span class=\"token number\">10</span>.00261655s, <span class=\"token number\">791</span>.59MB <span class=\"token builtin class-name\">read</span>\nRequests/sec:           <span class=\"token number\">935.56</span>\nTransfer/sec:           <span class=\"token number\">79</span>.14MB\nAvg Req Time:           <span class=\"token number\">21</span>.37768ms\nFastest Request:        <span class=\"token number\">2</span>.44047ms\nSlowest Request:        <span class=\"token number\">102</span>.748343ms\nNumber of Errors:       <span class=\"token number\">0</span></code></pre></div>\n<p>N·∫øu ch√∫ng ta s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p singleton connection, ch·ªâ cho ph√©p 1 idle connection th√¨ kh√¥ng h·ªÅ c√≥ 1 request n√†o b·ªã l·ªói, trong 10 gi√¢y thu ƒë∆∞·ª£c 9358 request, ph·∫£n h·ªìi v·ªõi th·ªùi gian 21ms.</p>\n<p><strong>Test endpoint <code class=\"language-text\">/products/pooled</code></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token number\">20</span> goroutine<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> running concurrently\n<span class=\"token number\">17010</span> requests <span class=\"token keyword\">in</span> <span class=\"token number\">9</span>.98895932s, <span class=\"token number\">1</span>.41GB <span class=\"token builtin class-name\">read</span>\nRequests/sec:           <span class=\"token number\">1702.88</span>\nTransfer/sec:           <span class=\"token number\">144</span>.04MB\nAvg Req Time:           <span class=\"token number\">11</span>.744808ms\nFastest Request:        <span class=\"token number\">1</span>.576952ms\nSlowest Request:        <span class=\"token number\">84</span>.103652ms\nNumber of Errors:       <span class=\"token number\">0</span></code></pre></div>\n<p>ƒê·ªânh ch·ª©, th·ªùi gian ph·∫£n h·ªìi nhanh g·∫•p ƒë√¥i ph∆∞∆°ng ph√°p singleton, v√† c≈©ng x·ª≠ l√Ω ƒë∆∞·ª£c t·ªõi 17k request trong v√≤ng 10 gi√¢y.</p>\n<p>Tuy nhi√™n m√¨nh v·∫´n mu·ªën h√† hi·∫øp c√°i API n√†y th√™m ch√∫t n·ªØa, h√£y tƒÉng ƒë·ªô kh√≥ cho game b·∫±ng vi·ªác tƒÉng s·ªë l∆∞·ª£ng goroutine l√∫c bench l√™n 200!</p>\n<p>B·∫°n c√≥ th·ªÉ ƒëo√°n ƒë∆∞·ª£c k·∫øt qu·∫£ r·ªìi ƒë·∫•y!</p>\n<p><strong>Test endpoint <code class=\"language-text\">/products/new</code></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token number\">100</span> requests <span class=\"token keyword\">in</span> <span class=\"token number\">51</span>.987238ms, <span class=\"token number\">8</span>.46MB <span class=\"token builtin class-name\">read</span>\nRequests/sec:           <span class=\"token number\">1923.55</span>\nTransfer/sec:           <span class=\"token number\">162</span>.71MB\nAvg Req Time:           <span class=\"token number\">103</span>.974476ms\nFastest Request:        <span class=\"token number\">48</span>.576556ms\nSlowest Request:        <span class=\"token number\">126</span>.737139ms\nNumber of Errors:       <span class=\"token number\">24624</span></code></pre></div>\n<p>Th·ªùi gian ph·∫£n h·ªìi tƒÉng ƒë√°ng k·ªÉ!</p>\n<p><strong>Test endpoint <code class=\"language-text\">/products/normal</code></strong></p>\n<p>Em n√†y c√≥ v·∫ª c≈©ng kh√¥ng kham n·ªïi s·ªë l∆∞·ª£ng request ƒë·ªìng th·ªùi ƒë√≥!</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token number\">8206</span> requests <span class=\"token keyword\">in</span> <span class=\"token number\">7</span>.75374229s, <span class=\"token number\">694</span>.15MB <span class=\"token builtin class-name\">read</span>\nRequests/sec:           <span class=\"token number\">1058.33</span>\nTransfer/sec:           <span class=\"token number\">89</span>.53MB\nAvg Req Time:           <span class=\"token number\">188</span>.977389ms\nFastest Request:        <span class=\"token number\">2</span>.688429ms\nSlowest Request:        <span class=\"token number\">965</span>.145213ms\nNumber of Errors:       <span class=\"token number\">3171</span></code></pre></div>\n<p><strong>Test endpoint <code class=\"language-text\">/products/pooled</code></strong></p>\n<p>Cu·ªëi c√πng v·∫´n ph·∫£i ƒë·ªÉ ch·ª•y g√°nh, v·ªõi connection pool, ch·ªâ c√≥ 15 request b·ªã fail</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token number\">16792</span> requests <span class=\"token keyword\">in</span> <span class=\"token number\">10</span>.005117575s, <span class=\"token number\">1</span>.39GB <span class=\"token builtin class-name\">read</span>\nRequests/sec:           <span class=\"token number\">1678.34</span>\nTransfer/sec:           <span class=\"token number\">141</span>.97MB\nAvg Req Time:           <span class=\"token number\">119</span>.165287ms\nFastest Request:        <span class=\"token number\">2</span>.598255ms\nSlowest Request:        <span class=\"token number\">1</span>.004313542s\nNumber of Errors:       <span class=\"token number\">15</span></code></pre></div>\n<p>Th·ªëng k√™ l·∫°i m·ªôt ch√∫t cho c√°c b·∫°n d·ªÖ h√¨nh dung:</p>\n<div class=\"table-wrapper\">\n<table>\n<thead>\n<tr>\n<th><strong>Concurent req</strong></th>\n<th><strong>/products/new</strong></th>\n<th><strong>/products/normal</strong></th>\n<th><strong>/products/pooled</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>20 gouroutine</strong></td>\n<td>37ms<br />100 req</td>\n<td>21ms<br />9k req</td>\n<td>11ms<br />17k req</td>\n</tr>\n<tr>\n<td><strong>200 goroutine</strong></td>\n<td>103ms<br />100 req<br />24k failed</td>\n<td>188ms<br />8k req<br />3k failed</td>\n<td>119ms<br />16k req<br />15 failed</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>C√°c b·∫°n c√≥ th·ªÉ th·∫•y, hi·ªáu nƒÉng khi s·ª≠ d·ª•ng connection pooling th·ªÉ hi·ªán r√µ r√†ng nh·∫•t khi m√¨nh tƒÉng s·ªë l∆∞·ª£ng request ƒë·ªìng th·ªùi. B√™n c·∫°nh ƒë√≥ s·ªë l∆∞·ª£ng request b·ªã l·ªói c≈©ng s·∫Ω gi·∫£m ƒëi.</p>\n<p>Tuy nhi√™n ƒë√°nh ƒë·ªïi ƒëi·ªÅu ƒë√≥ l√† c√°c request s·∫Ω ph·∫£i wait l√¢u h∆°n 1 ch√∫t x√≠u ƒë·ªÉ ƒë·ª£i connection t·ª´ pool.</p>\n<h2 id=\"k·∫øt-lu·∫≠n\" style=\"position:relative;\"><a href=\"#k%E1%BA%BFt-lu%E1%BA%ADn\" aria-label=\"k·∫øt lu·∫≠n permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>K·∫øt lu·∫≠n</h2>\n<p>T√∫m c√°i v√°y l·∫°i th√¨ connection pooling l√† m·ªôt k·ªπ thu·∫≠t gi√∫p tƒÉng hi·ªáu su·∫•t, gi·∫£m t·ªâ l·ªá request b·ªã l·ªói.\nKƒ© thu·∫≠t n√†y r·∫•t h·ªØu √≠ch v·ªõi c√°c h·ªá th·ªëng backend c√≥ l∆∞·ª£ng request ƒë·ªìng th·ªùi l·ªõn, do ƒë√≥ s·∫Ω r·∫•t t·ªët n·∫øu anh em hi·ªÉu r√µ v√† n·∫Øm v·ª©ng n√≥.</p>\n<p>Happy coding!</p>\n\n      <div class=\"footnotes\">\n        <hr/><strong>References:</strong>\n        <ol >\n    \n    <li class=\"footnote-list-item\" id=\"fn-1\" >\n          \n        \n      <a href=\"#fnref-1\" class=\"footnote-backref\" style=\"display:inline;text-decoration: none;\">\n        ‚Ü©\n      </a>\n    <p class=\"footnote-paragraph\" style=\"display:inline; margin-left: 5px;\"><a href=\"https://dev.mysql.com/doc/dev/mysql-server/latest/page_protocol_connection_phase.html\">Mysql Connection phase</a></p>\n      </li>\n      \n    \n\n    <li class=\"footnote-list-item\" id=\"fn-2\" >\n          \n        \n      <a href=\"#fnref-2\" class=\"footnote-backref\" style=\"display:inline;text-decoration: none;\">\n        ‚Ü©\n      </a>\n    <p class=\"footnote-paragraph\" style=\"display:inline; margin-left: 5px;\">Github Repo: <a href=\"https://github.com/kienmatu/go-connection-pooling-test\">go-connection-pooling-test</a></p>\n      </li>\n      \n    </ol></div>"},"primaryTag":null,"prev":{"frontmatter":{"title":"Fake data trong l·∫≠p tr√¨nh v√† testing","path":"/fake-data-trong-lap-trinh-va-testing"}},"next":null},"pageContext":{"postId":"f4df0e0a-3ee9-562f-8dc8-e05211466df4","primaryTag":"Backend","prevId":"6a76c465-44ee-5745-b92b-e50a871a9d0c","nextId":null}},"staticQueryHashes":["1116962356","2275848304","3082461530","3089453468","545095672"]}