{"componentChunkName":"component---src-templates-post-tsx","path":"/authentication-voi-jwt-luu-token-o-dau-la-bao-mat-nhat/","result":{"data":{"post":{"headings":[{"id":"d·∫´n-nh·∫≠p","depth":2,"value":"D·∫´n nh·∫≠p"},{"id":"first-thing-first","depth":2,"value":"First thing first"},{"id":"cac-ph∆∞∆°ng-th·ª©c-authentication","depth":2,"value":"C√°c ph∆∞∆°ng th·ª©c authentication"},{"id":"jwt-authentication","depth":2,"value":"JWT Authentication"},{"id":"m·ªï-x·∫ª-jwt","depth":3,"value":"M·ªï x·∫ª JWT"},{"id":"mu·ªën-gi·∫•u-thong-tin-kh·ªèi-jwt-thi-lam-sao","depth":3,"value":"Mu·ªën gi·∫•u th√¥ng tin kh·ªèi JWT th√¨ l√†m sao?"},{"id":"v·∫≠y-bay-gi·ªù-l∆∞u-access-token-·ªü-dau","depth":2,"value":"V·∫≠y b√¢y gi·ªù l∆∞u access token ·ªü ƒë√¢u?"},{"id":"local-storage","depth":3,"value":"Local Storage"},{"id":"cookie","depth":3,"value":"Cookie"},{"id":"t·ªïng-k·∫øt-l·∫°i-1-chut-nao","depth":3,"value":"T·ªïng k·∫øt l·∫°i 1 ch√∫t n√†o"},{"id":"implement-v·ªõi-cookie","depth":2,"value":"Implement v·ªõi Cookie"},{"id":"cach-set-httponly-phia-server","depth":3,"value":"C√°ch set HttpOnly ph√≠a server"},{"id":"client-g·ª≠i-token-di-th·∫ø-nao","depth":3,"value":"Client g·ª≠i token ƒëi th·∫ø n√†o?"},{"id":"enable-cors","depth":3,"value":"Enable CORS"},{"id":"ch·ªëng-csrf","depth":3,"value":"Ch·ªëng CSRF"},{"id":"t·ªïng-k·∫øt","depth":2,"value":"T·ªïng k·∫øt"},{"id":"faqs","depth":2,"value":"FAQs"}],"tableOfContents":"<ul>\n<li>\n<p><a href=\"#d%E1%BA%ABn-nh%E1%BA%ADp\">D·∫´n nh·∫≠p</a></p>\n</li>\n<li>\n<p><a href=\"#first-thing-first\">First thing first</a></p>\n</li>\n<li>\n<p><a href=\"#cac-ph%C6%B0%C6%A1ng-th%E1%BB%A9c-authentication\">C√°c ph∆∞∆°ng th·ª©c authentication</a></p>\n</li>\n<li>\n<p><a href=\"#jwt-authentication\">JWT Authentication</a></p>\n<ul>\n<li><a href=\"#m%E1%BB%95-x%E1%BA%BB-jwt\">M·ªï x·∫ª JWT</a></li>\n<li><a href=\"#mu%E1%BB%91n-gi%E1%BA%A5u-thong-tin-kh%E1%BB%8Fi-jwt-thi-lam-sao\">Mu·ªën gi·∫•u th√¥ng tin kh·ªèi JWT th√¨ l√†m sao?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#v%E1%BA%ADy-bay-gi%E1%BB%9D-l%C6%B0u-access-token-%E1%BB%9F-dau\">V·∫≠y b√¢y gi·ªù l∆∞u access token ·ªü ƒë√¢u?</a></p>\n<ul>\n<li><a href=\"#local-storage\">Local Storage</a></li>\n<li><a href=\"#cookie\">Cookie</a></li>\n<li><a href=\"#t%E1%BB%95ng-k%E1%BA%BFt-l%E1%BA%A1i-1-chut-nao\">T·ªïng k·∫øt l·∫°i 1 ch√∫t n√†o</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#implement-v%E1%BB%9Bi-cookie\">Implement v·ªõi Cookie</a></p>\n<ul>\n<li><a href=\"#cach-set-httponly-phia-server\">C√°ch set HttpOnly ph√≠a server</a></li>\n<li><a href=\"#client-g%E1%BB%ADi-token-di-th%E1%BA%BF-nao\">Client g·ª≠i token ƒëi th·∫ø n√†o?</a></li>\n<li><a href=\"#enable-cors\">Enable CORS</a></li>\n<li><a href=\"#ch%E1%BB%91ng-csrf\">Ch·ªëng CSRF</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#t%E1%BB%95ng-k%E1%BA%BFt\">T·ªïng k·∫øt</a></p>\n</li>\n<li>\n<p><a href=\"#faqs\">FAQs</a></p>\n</li>\n</ul>","frontmatter":{"title":"Authentication v·ªõi JWT, l∆∞u token ·ªü ƒë√¢u l√† b·∫£o m·∫≠t nh·∫•t?","path":"/authentication-voi-jwt-luu-token-o-dau-la-bao-mat-nhat","tags":["Web","Go"],"excerpt":"JWT lu√¥n l√† m·ªôt ph∆∞∆°ng ph√°p ph·ªï bi·∫øn trong vi·ªác authenticate user cho c√°c ·ª©ng d·ª•ng web. Nh∆∞ng c√¢u h·ªèi ƒë·∫∑t ra l√†, ch√∫ng ta n√™n l∆∞u JWT token ·ªü ƒë√¢u? ∆Øu nh∆∞·ª£c ƒëi·ªÉm c·ªßa t·ª´ng n∆°i l∆∞u nh∆∞ th·∫ø n√†o? L√†m c√°ch n√†o ƒë·ªÉ ch√∫ng ta c·∫£i thi·ªán n√≥?","created":"2023-03-18T05:04:51.904Z","createdPretty":"18 March, 2023","updated":"2023-03-18T05:04:51.904Z","updatedPretty":"18 March, 2023","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEJUlEQVQ4yy2UW0yTBwCF/7e9Lll2yczidGTODeO8IDExCJsKboiAyFRARCd3CrRSqNwEC+U2SkHKzRYoCghIgVnoRUoLLS2F1hYQnc4H3bIlS3bP9vot6J7O28l5+M4nHLLJCLeXcnShkuPOamIXa0lYrOOMu5Fkj5K05VbSve1k+zrJ9/cgCWgpWdNRvn6b6o1hah+N0vh4nJYnk7R/b0AIsUo4OCclzH6VI/ZSIuxlRC7JiXXXkehuIGm5mdQVFZd97WT5Oshfu4k4oKFkXUf5o0HkT0epf6an8ake5dNJhH2zYkLnigizSTnklFPycIBLRjkn58uJ99RzxtlAiqeZNHcLmf5O0h0qxOtaJA80SFc0SOwdFC90IV8donmzcPf9AkKsYvbMVfHaczsjPz7hRbgMSYeKL51ywmrPE2eo5FhzBjFaMftSIzk7WEZcq4jM6SbCMuKIyDxFmUtL07MJhF2WfPbO5bJ/tIeooT948effOGUvEFUvEO2sJPRqItFjJUQo0vhMcZGoxgy++CaTKPklrgR6SdLKuNBXTsMPU9RujCB8YsrjY1s257o72Ai+ze8WP0G//sa2hbtEThaxpyCGuPvVhOSdJCQ3hjidlNCME0RIzyJ9pOO0WsK57mJqn+u5/nAYYYc5m2BLHrts+ciKU7m1PMHeJ8MccFcRPlVIxJiYk4EGwnW5HNOKSF1t42hXDgkTFYi+6yXLqkRkv0HF4yGqNoYQgkyZfGTOYbcln50OCckzdVTcUVI60kb+tIoUWyOV+g4aTP2IXJ3IzJ10WcfoMo/QZNYhWe2leEOHbE1H5cYgwjZjOh+asgi2iNhtFtHWr+Fn9RL/tvqYHNBzZVzFT2oXv7S4UI32ob89zl/tXv5p8xHonaPQ0/0Ko7V+ytZvIWyd+ZrtxgyCTFlsN2VydrwKxWAnNbfUpEzVEG+spv5ON8o7GnLNKq4ZutHdHaFnbJCWewNkrajJDXQjXtUiW9chbJm+yAfGDEItEqJt1XxuLSPUWsTx+SoSF+pJWWwmwVlHqltJ/KKCWLeCxKUGclY6KfD2UOztRebto8yvQ7rah/CWIZWdphwkji4G/CbUHj15i2pKnVpurOi599CJ1mtg+IGFZEcTMa4azruVaH0G+r0zjK/bXqbaO4HYr0F489553pu+RKhZwuFZGUdnywmflXHYKiPKVkmcvYaEeQVJjiZOOK4Ts1jDaXc9mUvtZHvU5Ho6KFzuQeLTUBC4ifDGtym8bUjlnekLbJm5yPvGdHaYcwi+L+LT2UL2z13hoK2YsPmrRDquEe28TqxLQby7jq88jSQvK0nztpLhU5Pn70Z4fSqJzZXvGtLYOnOZIOMrjHZZROzd/Lm1iEO2kpdGOrJQwXFH1cuVp1x1nFlqImXTSCv/G+lBJ/8BD3AbLPFq42AAAAAASUVORK5CYII=","aspectRatio":1.36986301369863,"src":"/static/83b91a075fc38ba8b17bfcd6a0e410a0/cd8c1/JWT-authentication.png","srcSet":"/static/83b91a075fc38ba8b17bfcd6a0e410a0/8ac63/JWT-authentication.png 200w,\n/static/83b91a075fc38ba8b17bfcd6a0e410a0/3891b/JWT-authentication.png 400w,\n/static/83b91a075fc38ba8b17bfcd6a0e410a0/cd8c1/JWT-authentication.png 758w","sizes":"(max-width: 758px) 100vw, 758px"}}}},"html":"<h2 id=\"d·∫´n-nh·∫≠p\" style=\"position:relative;\"><a href=\"#d%E1%BA%ABn-nh%E1%BA%ADp\" aria-label=\"d·∫´n nh·∫≠p permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>D·∫´n nh·∫≠p</h2>\n<p>Ng√≥t ngh√©t c≈©ng ƒë√£ theo ngh·ªÅ code d·∫°o ƒë∆∞·ª£c h∆°n 4 nƒÉm, c≈©ng l√†m qua nhi·ªÅu d·ª± √°n.</p>\n<p>Nh∆∞ng h·∫ßu h·∫øt c√°c d·ª± √°n ·ªü c√¥ng ty l√∫c m√¨nh join th√¨ ƒë·ªÅu ƒë∆∞·ª£c d·ª±ng s·∫µn base v√† platform, ho·∫∑c l√† b√™ d·ª± √°n phase 1 ·ªü 1 n∆°i n√†o ƒë√≥ v·ªÅ l√†m ti·∫øp c√°c giai ƒëo·∫°n ti·∫øp theo, do ƒë√≥ m√¨nh kh√¥ng c√≥ c∆° h·ªôi ch·ªçt v√†o ph·∫ßn qu·∫£n l√Ω authentication v√† token l·∫Øm.</p>\n<p>∆† n√≥i th·∫ø th√¨ kh√¥ng c√≥ nghƒ©a l√† m√¨nh kh√¥ng l√†m ƒë∆∞·ª£c, m√¨nh c√≥ nghi√™n c·ª©u v√† √°p d·ª•ng v√†o d·ª± √°n ri√™ng, d·ª± √°n freelancer, v√† c·∫£ l√†m boilerplate cho c√°c assignment ph·ªèng v·∫•n n·ªØa üòù</p>\n<p>Ch∆∞a k·ªÉ l√∫c l√™n c√¥ng ty th√¨ m√¨nh c≈©ng mu·ªën ƒë∆∞a ki·∫øn th·ª©c research, ƒë·ªçc ƒë∆∞·ª£c l√™n ch√©m gi√≥ c√πng ƒë·ªìng nghi·ªáp.</p>\n<p>C√°i topic li√™n quan JWT n√†y c≈©ng ƒë∆∞·ª£c m√¨nh discuss ch√©m gi√≥ ƒë√¢u ƒë√≥ g·∫ßn 2 nƒÉm tr∆∞·ªõc v·ªõi 1 ng∆∞·ªùi anh, nay ƒë√£ qua Sing l√†m vi·ªác.</p>\n<p>JWT lu√¥n l√† m·ªôt ph∆∞∆°ng ph√°p ph·ªï bi·∫øn trong vi·ªác authenticate user cho c√°c ·ª©ng d·ª•ng web. Nh∆∞ng c√¢u h·ªèi ƒë·∫∑t ra l√†, ch√∫ng ta n√™n l∆∞u JWT token ·ªü ƒë√¢u? ∆Øu nh∆∞·ª£c ƒëi·ªÉm c·ªßa t·ª´ng n∆°i l∆∞u nh∆∞ th·∫ø n√†o? L√†m c√°ch n√†o ƒë·ªÉ ch√∫ng ta c·∫£i thi·ªán n√≥?</p>\n<h2 id=\"first-thing-first\" style=\"position:relative;\"><a href=\"#first-thing-first\" aria-label=\"first thing first permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>First thing first</h2>\n<p>M√¨nh l√† Ki√™n, developer v·ªõi m·ªôt tay ngh·ªÅ th·∫≠p c·∫©m, t·ª´ .NET t·ªõi Java, Angular, PHP, v√† g·∫ßn ƒë√¢y nh·∫•t l√† Golang, c√°i g√¨ m√¨nh c≈©ng ch·ªçt v√†o 1 ch√∫t, d·∫°o n√†y th√¨ focus h∆°n v√†o backend.</p>\n<p>Again, m√¨nh l√† m·ªôt ch√∫ developer th√≠ch vi·∫øt l√°ch, c≈©ng ƒë√£ kh√° l√¢u k·ªÉ t·ª´ b√†i blog cu·ªëi c√πng, h√¥m nay m√¨nh s·∫Ω kh·ªüi ƒë·ªông l·∫°i b·∫±ng topic ‚ÄúL∆∞u access token ·ªü ƒë√¢u th√¨ h·ª£p l√Ω?‚Äù</p>\n<h2 id=\"cac-ph∆∞∆°ng-th·ª©c-authentication\" style=\"position:relative;\"><a href=\"#cac-ph%C6%B0%C6%A1ng-th%E1%BB%A9c-authentication\" aria-label=\"cac ph∆∞∆°ng th·ª©c authentication permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>C√°c ph∆∞∆°ng th·ª©c authentication</h2>\n<p>Ch√∫ng ta ƒë·∫£o qua m·ªôt ch√∫t v·ªÅ c√°c ph∆∞∆°ng th·ª©c x√°c th·ª±c tr∆∞·ªõc,</p>\n<ol>\n<li>\n<p>Basic Authentication: D√πng base64 ƒë·ªÉ encrypt t√™n ng∆∞·ªùi d√πng v√† m·∫≠t kh·∫©u, v√† ƒë∆∞a n√≥ v√†o header:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token constant\">GET</span> <span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>example <span class=\"token constant\">HTTP</span><span class=\"token operator\">/</span><span class=\"token number\">1.1</span>\nHost<span class=\"token punctuation\">:</span> example<span class=\"token punctuation\">.</span>com\nAuthorization<span class=\"token punctuation\">:</span> Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ<span class=\"token operator\">==</span>\nAccept<span class=\"token punctuation\">:</span> application<span class=\"token operator\">/</span>json</code></pre></div>\n<p>Ph∆∞∆°ng th·ª©c n√†y qu√° c≈© kƒ© v√† kh√¥ng b·∫£o m·∫≠t, v√¨ b·∫°n c√≥ th·ªÉ d·ªÖ d√†ng decrypt l·∫°i chu·ªói authorization b√™n tr√™n.</p>\n</li>\n<li>\n<p>Session &#x26; Cookie: L∆∞u th√¥ng tin session ƒëƒÉng nh·∫≠p v√†o cookie c·ªßa tr√¨nh duy·ªát ph√≠a client, v√† l∆∞u session ph√≠a memory c·ªßa server. Nh∆∞·ª£c ƒëi·ªÉm ch√≠nh l√† kh√¥ng scale ƒë∆∞·ª£c, c≈©ng nh∆∞ kh√¥ng support ƒë∆∞·ª£c mobile app, v√¨ ch√∫ng ƒë√¢u c√≥ cookie üòó.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token constant\">GET</span> <span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>example <span class=\"token constant\">HTTP</span><span class=\"token operator\">/</span><span class=\"token number\">1.1</span>\nHost<span class=\"token punctuation\">:</span> example<span class=\"token punctuation\">.</span>com\nCookie<span class=\"token punctuation\">:</span> session_id<span class=\"token operator\">=</span>abc123def456<span class=\"token punctuation\">;</span> user_id<span class=\"token operator\">=</span><span class=\"token number\">789</span>\nAccept<span class=\"token punctuation\">:</span> application<span class=\"token operator\">/</span>json</code></pre></div>\n</li>\n<li>\n<p>Token-based: S·ª≠ d·ª•ng token ƒë·ªÉ x√°c th·ª±c ng∆∞·ªùi d√πng. Th√¥ng th∆∞·ªùng, khi ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p th√†nh c√¥ng, h·ªá th·ªëng s·∫Ω generate v√† tr·∫£ v·ªÅ 1 token, m√† ph·ªï bi·∫øn nh·∫•t ch√≠nh l√† JWT.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token constant\">GET</span> <span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>example <span class=\"token constant\">HTTP</span><span class=\"token operator\">/</span><span class=\"token number\">1.1</span>\nHost<span class=\"token punctuation\">:</span> example<span class=\"token punctuation\">.</span>com\nAuthorization<span class=\"token punctuation\">:</span> Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9<span class=\"token punctuation\">.</span>eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRmF\n    sZSIsImlhdCI6MTUxNjIzOTAyMn0<span class=\"token punctuation\">.</span>SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\nAccept<span class=\"token punctuation\">:</span> application<span class=\"token operator\">/</span>json</code></pre></div>\n</li>\n</ol>\n<p>V·ªõi ph∆∞∆°ng th·ª©c session &#x26; cookie, th√¨ dƒ© nhi√™n tr√¨nh duy·ªát auto nh·∫≠n authentication data v√† l∆∞u v√†o cookie r·ªìi, v·∫≠y c√≤n JWT ch√∫ng ta l∆∞u ·ªü ƒë√¢u?</p>\n<h2 id=\"jwt-authentication\" style=\"position:relative;\"><a href=\"#jwt-authentication\" aria-label=\"jwt authentication permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JWT Authentication</h2>\n<p>JWT (JSON Web Token) nh∆∞ t√™n g·ªçi, l√† token ƒë∆∞·ª£c l∆∞u d∆∞·ªõi d·∫°ng text, c√≥ th·ªÉ parse qua JSON v√† ch·ª©a nh·ªØng th√¥ng tin li√™n quan ƒë·ªÉ authenticate.</p>\n<h3 id=\"m·ªï-x·∫ª-jwt\" style=\"position:relative;\"><a href=\"#m%E1%BB%95-x%E1%BA%BB-jwt\" aria-label=\"m·ªï x·∫ª jwt permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>M·ªï x·∫ª JWT</h3>\n<p>JWT g·ªìm 3 ph·∫ßn: Header, Payload v√† Signature.</p>\n<ul>\n<li>Header: Ch·ª©a th√¥ng tin v·ªÅ lo·∫°i token v√† thu·∫≠t to√°n m√£ h√≥a ƒë∆∞·ª£c s·ª≠ d·ª•ng.</li>\n<li>Payload: Ch·ª©a c√°c th√¥ng tin li√™n quan ƒë·∫øn user (v√≠ d·ª• nh∆∞ id, t√™n, email, quy·ªÅn h·∫°n, th·ªùi gian h·∫øt h·∫°n token, etc.).</li>\n<li>Signature: L√† m·ªôt chu·ªói ƒë∆∞·ª£c m√£ h√≥a b·∫±ng thu·∫≠t to√°n ch·ªØ k√Ω s·ªë (signature algorithm) v√† ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch k·∫øt h·ª£p header, payload v√† secret key (kh√≥a b√≠ m·∫≠t) m√† ch·ªâ server bi·∫øt.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5aea77eb7dcf258a3dbf86fbafeb1cd0/951a4/jwt-content-payload-decoded.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA00lEQVQoz3WR7W7DIAxF+/4vuSk/VuVzahsI2NhngmxVVyWgiwVG9j1w6fuer/6KFEWt4PBfXleYpomu64ghoqqISMu962IhYcMDXyI2Bnxa8XnFxwc+R0ycOrcYiVski5BzxswOdclLYf1QQqeEz9Ji3adOma9K3H69msGa4B6rbY5GcxiyM0bne3OWqrTHW3KG7CTbC+aUkLDhUg5Rq5pDf3bzA+3n9U7FzCoN39zOkffqnHZ95grYHWSAcnvx8I7859AP3uW1oBVrH2TJMT1H/gEXrSdajzAFhAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JWT Payload\"\n        title=\"JWT Payload\"\n        src=\"/static/5aea77eb7dcf258a3dbf86fbafeb1cd0/c1b63/jwt-content-payload-decoded.png\"\n        srcset=\"/static/5aea77eb7dcf258a3dbf86fbafeb1cd0/5a46d/jwt-content-payload-decoded.png 300w,\n/static/5aea77eb7dcf258a3dbf86fbafeb1cd0/0a47e/jwt-content-payload-decoded.png 600w,\n/static/5aea77eb7dcf258a3dbf86fbafeb1cd0/c1b63/jwt-content-payload-decoded.png 1200w,\n/static/5aea77eb7dcf258a3dbf86fbafeb1cd0/951a4/jwt-content-payload-decoded.png 1355w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Ch√∫ng ta c√≥ th·ªÉ g√°n th√™m information c·∫ßn thi·∫øt v√†o ph·∫ßn payload b√™n c·∫°nh nh·ªØng \"Claim\" c∆° b·∫£n ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong <a href=\"https://www.rfc-editor.org/rfc/rfc7519\">RFC 7519</a>.</p>\n<h3 id=\"mu·ªën-gi·∫•u-thong-tin-kh·ªèi-jwt-thi-lam-sao\" style=\"position:relative;\"><a href=\"#mu%E1%BB%91n-gi%E1%BA%A5u-thong-tin-kh%E1%BB%8Fi-jwt-thi-lam-sao\" aria-label=\"mu·ªën gi·∫•u thong tin kh·ªèi jwt thi lam sao permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mu·ªën gi·∫•u th√¥ng tin kh·ªèi JWT th√¨ l√†m sao?</h3>\n<p>B·∫°n c√≥ th·ªÉ s·∫Ω th·∫Øc m·∫Øc l√† m·ªôt v√†i th√¥ng tin nh∆∞ username, email c√≥ th·ªÉ b·ªã l·ªô t·ª´ vi·ªác decode JWT. V√¨ n√≥ ch·ªâ ƒë∆∞·ª£c Encode ch·ª© kh√¥ng ƒë∆∞·ª£c Encrypt.</p>\n<p>ƒê·ªÉ gi·∫•u th√¥ng tin kh·ªèi JWT, b·∫°n c√≥ th·ªÉ m√£ h√≥a th√¥ng tin tr∆∞·ªõc khi ƒë∆∞a v√†o JWT. Tuy nhi√™n, JWT th∆∞·ªùng ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ x√°c th·ª±c ng∆∞·ªùi d√πng v√† kh√¥ng ƒë∆∞·ª£c m√£ h√≥a. Thay v√†o ƒë√≥, n√≥ ƒë∆∞·ª£c ‚Äúsign‚Äù (k√Ω) ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh to√†n v·∫πn c·ªßa d·ªØ li·ªáu. (Tham kh·∫£o b√†i vi·∫øt v·ªÅ <a href=\"https://devgiangho.github.io/https-la-gi-giai-thich-chi-tiet-ssl-tls-bang-chuyen-tinh-cho-va-meo\">HTTP v√† HTTPS</a> ƒë·ªÉ t√¨m hi·ªÉu th√™m v·ªÅ ch·ªØ k√Ω nh√©).</p>\n<p>B·∫°n c≈©ng c√≥ th·ªÉ tham kh·∫£o th√™m chi ti·∫øt t·∫°i <a href=\"https://www.rfc-editor.org/rfc/rfc7516\">RFC-7516</a> v·ªÅ vi·ªác m√£ h√≥a c√°c tr∆∞·ªùng trong JWT. Tuy nhi√™n, h√£y nh·ªõ r·∫±ng vi·ªác m√£ h√≥a trong JWT c√≥ th·ªÉ l√†m tƒÉng ƒë·ªô ph·ª©c t·∫°p v√† l√†m ch·∫≠m vi·ªác x√°c th·ª±c ng∆∞·ªùi d√πng.</p>\n<p>Tham kh·∫£o v·ªÅ encrypt - decrypt cho ai quan t√¢m: <a href=\"https://advancedweb.hu/how-to-sign-verify-and-encrypt-jwts-in-node/\">https://advancedweb.hu/how-to-sign-verify-and-encrypt-jwts-in-node/</a></p>\n<h2 id=\"v·∫≠y-bay-gi·ªù-l∆∞u-access-token-·ªü-dau\" style=\"position:relative;\"><a href=\"#v%E1%BA%ADy-bay-gi%E1%BB%9D-l%C6%B0u-access-token-%E1%BB%9F-dau\" aria-label=\"v·∫≠y bay gi·ªù l∆∞u access token ·ªü dau permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>V·∫≠y b√¢y gi·ªù l∆∞u access token ·ªü ƒë√¢u?</h2>\n<p>Ch√∫ng ta c√≥ th·ªÉ b·ªè qua lu√¥n session storage v√† c·∫£ application state, v√¨ ch√∫ng qu√° m·ªèng manh y·∫øu ƒëu·ªëi, ƒë√≥ng tab ho·∫∑c ctrl + F5 c√°i l√† ƒëi m·∫•t r·ªìi.</p>\n<h3 id=\"local-storage\" style=\"position:relative;\"><a href=\"#local-storage\" aria-label=\"local storage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Local Storage</h3>\n<p>ƒê√¢y ch√≠nh l√† 1 n∆°i nguy hi·ªÉm, b·ªüi v√¨ local storage c√≥ th·ªÉ ƒë∆∞·ª£c truy c·∫≠p t·ª´ b·∫•t k·ª≥ script n√†o ch·∫°y tr√™n c√πng 1 domain (v√† session storage c≈©ng th·∫ø nha).</p>\n<p>Ch√∫ng ta g·ªçi ƒë√≥ l√† l·ªó h·ªïng XSS, t·ª©c <strong><em>Cross-Site Scripting,</em></strong> k·∫ª x·∫•u ch·ªâ c·∫ßn inject script v√†o target l√† ƒë√£ c√≥ th·ªÉ l·∫•y ƒë∆∞·ª£c token.</p>\n<p>ƒêi·ªÉm ch√≠ m·∫°ng th·ª© 2 ƒë√≥ ch√≠nh l√† local storage kh√¥ng c√≥ th·ªùi gian expire, n√≥ s·∫Ω c√≤n s·ªëng m√£i. B√¨nh th∆∞·ªùng con ng∆∞·ªùi s·ªëng l√¢u th√¨ m·ª´ng, c√≤n token s·ªëng l√¢u th√¨ l·∫°i l√† v·∫•n ƒë·ªÅ üÉè</p>\n<h3 id=\"cookie\" style=\"position:relative;\"><a href=\"#cookie\" aria-label=\"cookie permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cookie</h3>\n<p>M·ªôt c√°ch kh√°c ch√≠nh l√† l∆∞u v√†o cookie, m·∫∑c d√π cookie v·∫´n c√≥ th·ªÉ truy c·∫≠p t·ª´ script trong c√πng domain b·∫±ng c√°ch g·ªçi <code class=\"language-text\">document.cookie</code> .</p>\n<p>Nh∆∞ng n√≥ v·∫´n an to√†n h∆°n localstorage, t·∫°i sao?</p>\n<p>Th·ª© nh·∫•t, cookie c√≥ th·ªùi gian expiration, kh√¥ng s·ªëng th·ªç nh∆∞ local storage.</p>\n<p>Th·ª© 2, cookie c√≥ 1 flag g·ªçi l√† <code class=\"language-text\">httpOnly</code>. Flag n√†y s·∫Ω gi√∫p ngƒÉn ch·∫∑n cookie truy c·∫≠p b·ªüi client side.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 668px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a50f2826177d2a301edd1bc4224b5ee7/74866/httponly-flag-in-cookie.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiElEQVQoz02R2W7rMBBD/f8/eHGbeF/ifZNjSXYBFqSTNg/CWPKI5BkFznsU1QNFVWOYZlR1g6wodZYVFdK8RF5WyMsH2n7AYjbMq8G0mqsuq+r7O+Dluu2xmg3lo8Y9ThDGKb7uEcpHo0ae04CCtzCWIY3jNMc4zTK9xymarkewrAbOHzi/v9H1A8I4UTKmSrIcUZyCPfOyoh9G7NbCbE9Y51Sdc4jTTHSkDZjMOi/RpuuULi1KiWV5ia8wEso4z0rAS9tzx+7cVa2V4DSvsBRcjJGgPw7UbSskotzCCFGSak93Gnf9qGSX0KvuVn3jvEgnUGx/4DhOtH2PKMl+cdO80OIc2Te+sJ77rsubqlMvKbw//hJ+IvMnBdZt0/yeu70SDqP6KEJUJuQ/pqURzzRDbvxxomk73KMYYZLKlQ/07/9NOEw1jJNG45z/QLd65Yv0E/k89cocMJGL8nppijIxBYV1nL8pmY5VY1mMzIL3gOnEtERU1TLa05TzYn1aq/XGfRuZ1/4HGoT2Q41l3gMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"HttpOnly flag in cookie settings\"\n        title=\"HttpOnly flag in cookie settings\"\n        src=\"/static/a50f2826177d2a301edd1bc4224b5ee7/74866/httponly-flag-in-cookie.png\"\n        srcset=\"/static/a50f2826177d2a301edd1bc4224b5ee7/5a46d/httponly-flag-in-cookie.png 300w,\n/static/a50f2826177d2a301edd1bc4224b5ee7/0a47e/httponly-flag-in-cookie.png 600w,\n/static/a50f2826177d2a301edd1bc4224b5ee7/74866/httponly-flag-in-cookie.png 668w\"\n        sizes=\"(max-width: 668px) 100vw, 668px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>HttpOnly flag in cookie settings</p>\n<p>L√∫c n√†y khi c√°c b·∫°n truy c·∫≠p <code class=\"language-text\">document.cookie</code> n√≥ ch·ªâ tr·∫£ v·ªÅ empty m√† th√¥i.</p>\n<p><strong>Khoan!</strong></p>\n<p>N·∫øu b·∫≠t HttpOnly th√¨ cookie c≈©ng s·∫Ω b·ªã d√≠nh ch∆∞·ªüng l·ªùi nguy·ªÅn CSRF (<strong>Cross-Site Request Forgery</strong>)</p>\n<p>CSRF t·ª©c l√† request ƒë∆∞·ª£c g·ª≠i ƒëi s·∫Ω kh√¥ng ph·∫£i g·ª≠i t·ª´ domain ƒë√£ ƒëƒÉng nh·∫≠p, m√† l√† 1 domain l·∫° n√†o ƒë√≥.</p>\n<p>V√≠ d·ª• b·∫°n ƒë√£ ƒëƒÉng nh·∫≠p facebook, sau ƒë√≥ nh·ªù b·∫•m v√†o 1 link \"n√≥ng b·ªèng\" share h√†ng n√†o ƒë√≥ tr√™n b·∫£ng tin, b·∫°n truy c·∫≠p trang gi·∫£ m·∫°o <code class=\"language-text\">facebook-aa.com</code>.\nTrang n√†y s·∫Ω inject 1 ƒëo·∫°n script g·ª≠i request t·ªõi <code class=\"language-text\">facebook.com/change-password?newPassword=ABC</code>, request n√†y s·∫Ω auto ƒë∆∞·ª£c l·∫•y cookie c·ªßa <code class=\"language-text\">facebook.com</code> t·ª´ browser.</p>\n<p>ƒê·ªÉ tho√°t kh·ªèi CSRF, ch√∫ng ta c·∫ßn th√™m 2 flag n·ªØa, ch√≠nh l√† <code class=\"language-text\">SameSite=Strict</code> , flag n√†y ch·ªâ cho ph√©p g·ª≠i cookie ƒëi tr√™n c√πng 1 domain ƒë√£ set m√† th√¥i.</p>\n<p>M√† ƒë·ªÉ b·∫≠t SameSite strict, th√¨ ch√∫ng ta c≈©ng ph·∫£i b·∫≠t lu√¥n flag <strong><code class=\"language-text\">Secure</code></strong>, flag n√†y ch·ªâ cho ph√©p g·ª≠i cookie ƒëi qua k·∫øt n·ªëi HTTPS. Xem th√™m t·∫°i <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite\">MDN - Samesite cookie flag</a></p>\n<p>Nh∆∞·ª£c ƒëi·ªÉm c·ªßa vi·ªác ƒë·∫∑t same-site ch√≠nh l√† kh√¥ng b·∫≠t ƒë∆∞·ª£c t√≠nh nƒÉng cross-site nh∆∞ social login c√°c th·ª© c·∫ßn k·∫øt n·ªëi t·ªõi 1 service 3rd party.</p>\n<p>T·∫•t c·∫£ bi·ªán ph√°p tr√™n c≈©ng kh√¥ng ƒë·∫£m b·∫£o 100% tr√°nh ƒë∆∞·ª£c CSRF, cho n√™n ch√∫ng ta v·∫´n c·∫ßn implement 1 c∆° ch·∫ø n√†o ƒë√≥ ƒë·ªÉ tr√°nh CSRF ph√≠a server.</p>\n<h3 id=\"t·ªïng-k·∫øt-l·∫°i-1-chut-nao\" style=\"position:relative;\"><a href=\"#t%E1%BB%95ng-k%E1%BA%BFt-l%E1%BA%A1i-1-chut-nao\" aria-label=\"t·ªïng k·∫øt l·∫°i 1 chut nao permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>T·ªïng k·∫øt l·∫°i 1 ch√∫t n√†o</h3>\n<div class=\"table-wrapper\">\n<table>\n<thead>\n<tr>\n<th></th>\n<th>LocalStorage</th>\n<th>Cookies</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>XSS</td>\n<td>C√≥</td>\n<td>N·∫øu set flag HttpOnly th√¨ tr√°nh ƒë∆∞·ª£c XSS.</td>\n</tr>\n<tr>\n<td>Expiration</td>\n<td>Kh√¥ng</td>\n<td>C√≥</td>\n</tr>\n<tr>\n<td>CSRF</td>\n<td>Kh√¥ng</td>\n<td>B·ªã d√≠nh CSRF, m·∫∑c d√π n·∫øu set <code class=\"language-text\">SameSite=Strict</code> th√¨ s·∫Ω ƒë·ª° nguy c∆° nh∆∞ng v·∫´n ph·∫£i implement c∆° ch·∫ø ch·ªëng CSRF ph√≠a server.</td>\n</tr>\n</tbody>\n</table>\n</div>\nT√∫m c√°i v√°y l·∫°i th√¨ c√°ch an to√†n nh·∫•t ƒë·ªÉ l∆∞u token v·∫´n l√† ƒë∆∞a v√†o cookie v√† set m·ªôt v√†i flag, tuy nhi√™n t√πy v√†o nghi·ªáp v·ª• d·ª± √°n th√¨ ch√∫ng ta c√≥ th·ªÉ ch·ªçn ph∆∞∆°ng √°n localstorage.\n<h2 id=\"implement-v·ªõi-cookie\" style=\"position:relative;\"><a href=\"#implement-v%E1%BB%9Bi-cookie\" aria-label=\"implement v·ªõi cookie permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Implement v·ªõi Cookie</h2>\n<h3 id=\"cach-set-httponly-phia-server\" style=\"position:relative;\"><a href=\"#cach-set-httponly-phia-server\" aria-label=\"cach set httponly phia server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>C√°ch set HttpOnly ph√≠a server</h3>\n<p>T·∫•t nhi√™n r·ªìi, khi b·∫°n b·∫≠t mode HttpOnly, th√¨ client s·∫Ω kh√¥ng c√≥ quy·ªÅn truy c·∫≠p v√†o cookie, do ƒë√≥ ch√∫ng ta ph·∫£i th·ª±c hi·ªán vi·ªác set cookie th√¥ng qua backend.</p>\n<p>V·ªõi nodejs, chuy·ªán n√†y kh√° d·ªÖ:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> token <span class=\"token operator\">=</span> jwt<span class=\"token punctuation\">.</span><span class=\"token function\">sign</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">,</span> <span class=\"token constant\">SECRET</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">cookie</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"accessToken\"</span><span class=\"token punctuation\">,</span> token<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    maxAge<span class=\"token punctuation\">:</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 1 hour</span>\n    httpOnly<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    secure<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    sameSite<span class=\"token punctuation\">:</span> <span class=\"token string\">\"strict\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Cookie set!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>T∆∞∆°ng t·ª± cho Go v·ªõi Gin:</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\">r <span class=\"token operator\">:=</span> gin<span class=\"token punctuation\">.</span><span class=\"token function\">Default</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Middleware to set the access token cookie</span>\nr<span class=\"token punctuation\">.</span><span class=\"token function\">Use</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">*</span>gin<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\taccessToken <span class=\"token operator\">:=</span> http<span class=\"token punctuation\">.</span>Cookie<span class=\"token punctuation\">{</span>\n\t\tName<span class=\"token punctuation\">:</span>     <span class=\"token string\">\"accessToken\"</span><span class=\"token punctuation\">,</span>\n\t\tValue<span class=\"token punctuation\">:</span>    <span class=\"token string\">\"myAccessToken\"</span><span class=\"token punctuation\">,</span>\n\t\tHttpOnly<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\t\tSecure<span class=\"token punctuation\">:</span>   <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\t\tSameSite<span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">.</span>SameSiteStrictMode<span class=\"token punctuation\">,</span>\n\t\tMaxAge<span class=\"token punctuation\">:</span>   <span class=\"token number\">3600</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 1 hour</span>\n\t<span class=\"token punctuation\">}</span>\n\thttp<span class=\"token punctuation\">.</span><span class=\"token function\">SetCookie</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Writer<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>accessToken<span class=\"token punctuation\">)</span>\n\tc<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"client-g·ª≠i-token-di-th·∫ø-nao\" style=\"position:relative;\"><a href=\"#client-g%E1%BB%ADi-token-di-th%E1%BA%BF-nao\" aria-label=\"client g·ª≠i token di th·∫ø nao permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Client g·ª≠i token ƒëi th·∫ø n√†o?</h3>\n<p>B·∫°n c√≥ th·ªÉ t·ª± h·ªèi, l√†m sao client c√≥ th·ªÉ l·∫•y ƒë∆∞·ª£c token, trong khi cookie ƒë√£ kh√¥ng c√≤n xu·∫•t hi·ªán trong con m·∫Øt c·ªßa client script n·ªØa?</p>\n<p>ƒê√°p √°n l√† header n√†y, h√£y th√™m n√≥ v√†o middleware g·ª≠i request ph√≠a client.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">Access<span class=\"token operator\">-</span>Control<span class=\"token operator\">-</span>Allow<span class=\"token operator\">-</span>Credentials<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span></code></pre></div>\n<p>Khi header n√†y ƒë∆∞·ª£c set true, tr√¨nh duy·ªát s·∫Ω t·ª± ƒë·ªông g·ª≠i b·∫•t k·ª≥ cookie n√†o c√≥ thu·ªôc t√≠nh HttpOnly m√† c√≥ domain l√† domain ƒëang g·ª≠i request t·ªõi. (Tham kh·∫£o t·∫°i <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials\">MDN</a>)</p>\n<p>V·ªõi axios, ch√∫ng ta c√≥ th·ªÉ enable b·∫±ng c√°ch set <strong><code class=\"language-text\">withCredentials: true</code></strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://api.domainA.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> withCredentials<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Nh∆∞ng ·ªü ƒë√¢y l·∫°i ƒë·∫ª ra 1 c·ªßa n·ª£ n·ªØa, ƒë√≥ ch√≠nh l√† CORS, v√≠ d·ª• b·∫°n ƒëƒÉng nh·∫≠p v√† l∆∞u cookie ·ªü <code class=\"language-text\">auth.domainA.com</code>, nh∆∞ng l·∫°i c·∫ßn g·ª≠i request t·ªõi <code class=\"language-text\">api.domainA.com</code> th√¨ d·ªÖ b·ªã ch·∫∑n l·∫Øm.</p>\n<p>Th√¨ ch√∫ng ta ti·∫øp t·ª•c ph·∫£i enable CORS ph√≠a server.</p>\n<h3 id=\"enable-cors\" style=\"position:relative;\"><a href=\"#enable-cors\" aria-label=\"enable cors permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Enable CORS</h3>\n<p>CORS - Cross-Origin Resource Sharing, l√† m·ªôt t√≠nh nƒÉng b·∫£o m·∫≠t c·ªßa tr√¨nh duy·ªát gi√∫p ngƒÉn ch·∫∑n ho·∫∑c gi·ªõi h·∫°n nh·ªØng resource ƒë∆∞·ª£c cho ph√©p theo origin (field n√†y tr√¨nh duy·ªát t·ª± th√™m v√¥).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 636px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4d0d53481333044a6ae30be21fd558ba/9be90/request-header-origin.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABDUlEQVQoz42Ri2rDMAxF8/+fWErzcN62Yztp19R5nBF1HYw9mEBIGHx1dJVM05XT6UyapuR5TpYXrOvK19hh34CNfd/Ytt8zecSVx62ma2vOl4xLmlGokrKq6bUhLxS9DegJGr9yj/tzxM6PkRw018mT5bl8Vqqkqhu0sVg70PWaptOo1lL1DusCzvsP0f1biqD3QYiqqqZtO8Zxou06VFWjjcHYQ9xirJFBMS5/CW4MzqHKijBO+DDKAK2NiIUwisj1duM/IYTGGIpCcZ9nOciyrlJf/cvwGCPLssjb0R+kzxqJy8I8P0je3u6fKzZNK+s554XsyIN4FPKAsYP4NwyOpu3kaLJROHwN4vc78lwbbtSlWtUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Tr√¨nh duy·ªát s·∫Ω t·ª± ƒë·ªông th√™m field origin v√†o\"\n        title=\"Tr√¨nh duy·ªát s·∫Ω t·ª± ƒë·ªông th√™m field origin v√†o\"\n        src=\"/static/4d0d53481333044a6ae30be21fd558ba/9be90/request-header-origin.png\"\n        srcset=\"/static/4d0d53481333044a6ae30be21fd558ba/5a46d/request-header-origin.png 300w,\n/static/4d0d53481333044a6ae30be21fd558ba/0a47e/request-header-origin.png 600w,\n/static/4d0d53481333044a6ae30be21fd558ba/9be90/request-header-origin.png 636w\"\n        sizes=\"(max-width: 636px) 100vw, 636px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Tr√¨nh duy·ªát s·∫Ω t·ª± ƒë·ªông th√™m field origin v√†o</p>\n<p>Flow n√¥m na l√† n·∫øu server ƒë√°nh d·∫•u origin l√† ƒë∆∞·ª£c ph√©p (th√¥ng qua header), th√¨ tr√¨nh duy·ªát s·∫Ω g·ª≠i request ƒëi, c√≤n n·∫øu server kh√¥ng cho, th√¨ browser s·∫Ω ch·∫∑n request l·∫°i.</p>\n<p>Do ƒë√≥ m√† dev c√≥ th·ªÉ bypass b·∫±ng 1 extension c·ªßa tr√¨nh duy·ªát üòú, tuy nhi√™n ai l·∫°i b·∫Øt user ƒëi c√†i extension bao gi·ªù, do ƒë√≥ ta ph·∫£i implement n√≥.</p>\n<p>Nodejs:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> cors <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cors\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>\n  <span class=\"token function\">cors</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    origin<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"https://domainA.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"https://domainB.com/\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Nh∆∞ code tr√™n ch√∫ng ta s·∫Ω allow 2 origin ƒë∆∞·ª£c g·ª≠i request t·ªõi ch√≠nh l√† domainA v√† domainB.</p>\n<p>Kh√¥ng khuy·∫øn kh√≠ch d√πng pattern <code class=\"language-text\">origin: *</code></p>\n<p>V·ªõi Go Gin, th√¨ c√≥ th·ªÉ tham kh·∫£o <a href=\"https://github.com/gin-contrib/cors\">lib n√†y</a> nh√©</p>\n<h3 id=\"ch·ªëng-csrf\" style=\"position:relative;\"><a href=\"#ch%E1%BB%91ng-csrf\" aria-label=\"ch·ªëng csrf permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ch·ªëng CSRF</h3>\n<p>Kƒ© thu·∫≠t n√†y kh√° ƒë∆°n gi·∫£n, v·ªõi m·ªói form request, ch√∫ng ta generate 1 csrf token d·ª±a v√†o session hi·ªán t·∫°i, client g√°n n√≥ v√†o 1 hidden input, v√† server s·∫Ω x·ª≠ l√Ω field n√†y b·∫±ng 1 thu·∫≠t to√°n n√†o ƒë√≥, n·∫øu h·ª£p l·ªá th√¨ cho qua.</p>\n<p>V√≠ d·ª• code ·ªü client:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/submit-form<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>POST<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>_csrf<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ csrfToken }}<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>username<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Username:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>username<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>username<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Password:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Submit<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>H·∫ßu h·∫øt c√°c framework ƒë·ªÅu support CSRF r·ªìi, x∆∞a m√¨nh code laravel PHP th√¨ n√≥ support middleware c√≥ s·∫µn d·ªÖ nh∆∞ ƒÉn b√°nh.</p>\n<p>V·ªõi Go, tham kh·∫£o th∆∞ vi·ªán <a href=\"https://github.com/utrack/gin-csrf\">gin-crsf</a> ƒë·ªÉ th√™m 1 middleware:</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\">r<span class=\"token punctuation\">.</span><span class=\"token function\">Use</span><span class=\"token punctuation\">(</span>csrf<span class=\"token punctuation\">.</span><span class=\"token function\">Middleware</span><span class=\"token punctuation\">(</span>csrf<span class=\"token punctuation\">.</span>Options<span class=\"token punctuation\">{</span>\n\t\tSecret<span class=\"token punctuation\">:</span> <span class=\"token string\">\"kiendeptrai\"</span><span class=\"token punctuation\">,</span>\n\t\tErrorFunc<span class=\"token punctuation\">:</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">*</span>gin<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CSRF token mismatch\"</span><span class=\"token punctuation\">)</span>\n\t\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">Abort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"t·ªïng-k·∫øt\" style=\"position:relative;\"><a href=\"#t%E1%BB%95ng-k%E1%BA%BFt\" aria-label=\"t·ªïng k·∫øt permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>T·ªïng k·∫øt</h2>\n<p>Hoooo, m√¨nh kh√¥ng nghƒ© l√† b√†i n√†y l·∫°i d√†i t·ªõi v·∫≠y, c·ª© nghƒ© l√† vi·∫øt trong 1 bu·ªïi t·ªëi, m√† ph·∫£i t·ªõi tr∆∞a ng√†y h√¥m sau m·ªõi xong.</p>\n<p>Hi v·ªçng sau b√†i n√†y b·∫°n s·∫Ω c√≥ 1 c√°i nh√¨n t·ªïng quan v·ªÅ JWT authenticaion v√† nh·ªØng v·∫•n ƒë·ªÅ b√™n c·∫°nh nh∆∞ CORS v√† b·∫£o m·∫≠t c√°c request v·ªõi CSRF.</p>\n<p>Happy coding!</p>\n<h2 id=\"faqs\" style=\"position:relative;\"><a href=\"#faqs\" aria-label=\"faqs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FAQs</h2>\n<p>Sau khi up b√†i n√†y th√¨ c√≥ v·∫ª anh em dev c√≥ v√†i c√¢u h·ªèi li√™n quan, m√¨nh ƒë√£ tr·∫£ l·ªùi trong comment (b√™n Viblo), v√† m√¨nh t·ªïng h·ª£p l·∫°i ·ªü ƒë√¢y lu√¥n:</p>\n<ol>\n<li>Th·∫ø mu·ªën d√πng chung c·∫£ moblie app th√¨ sao, khi cookie kh√¥ng set ƒë∆∞·ª£c v√†o <code class=\"language-text\">authorization</code> header?<br>\nPh√≠a mobile v·∫´n l∆∞u token r·ªìi ƒë·∫©y v√†o authorization header b√¨nh th∆∞·ªùng.\nTrong middleware authentication ph√≠a backend, ta c√≥ th·ªÉ quy·∫øt ƒë·ªãnh l√† mobile th√¨ ta s·∫Ω check trong authorization header, ng∆∞·ª£c l·∫°i, l·∫•y t·ª´ cookie.\nT√πy v√†o tr∆∞·ªùng h·ª£p API backend x√¢y m·ªõi hay s·ª≠ d·ª•ng l·∫°i th√¨ ch√∫ng ta quy·∫øt ƒë·ªãnh vi·ªác implement cho h·ª£p l√Ω.</li>\n<li>Th·∫ø refresh token th√¨ sao?\nRefresh token v·∫´n l∆∞u v√†o cookie v√¨ n√≥ v·∫´n l√† 1 token, ch·ªâ l√† TTL c·ªßa n√≥ d√†i h∆°n m√† th√¥i. B√™n c·∫°nh ƒë√≥, set th√™m path cho refresh token trong cookie, ch·ªâ accept <code class=\"language-text\">/refresh_token</code> ch·∫≥ng h·∫°n.</li>\n<li>Cookie t·ªëi ƒëa 4KB dung l∆∞·ª£ng, c√≥ khi n√†o kh√¥ng ƒë·ªß?\nN·∫øu kh√¥ng qu√° ƒë·∫∑c bi·ªát th√¨ ƒë·ªß, m√¨nh ƒë√£ test 1 c·∫∑p access token v√† refresh token v·ªõi nh·ªØng th√¥ng tin c∆° b·∫£n, chi·∫øm ƒë√¢u ƒë√≥ <code class=\"language-text\">550Bytes</code>, v·ªõi nhi√™u ƒë√≥ th√¨ kh√¥ng tr√†n cookie ƒë∆∞·ª£c :D</li>\n</ol>\n<p>Tham kh·∫£o th√™m:</p>\n<p><a href=\"https://ironeko.com/posts/how-to-store-access-tokens-localstorage-cookies-or-httponly\">https://ironeko.com/posts/how-to-store-access-tokens-localstorage-cookies-or-httponly</a></p>\n<p><a href=\"https://owasp.org/www-community/attacks/csrf\">https://owasp.org/www-community/attacks/csrf</a></p>"},"primaryTag":{"name":"Web","color":"#007acc"},"prev":{"frontmatter":{"title":"HTTPS l√† g√¨? Gi·∫£i th√≠ch chi ti·∫øt SSL/TLS b·∫±ng chuy·ªán t√¨nh Ch√≥ v√† M√®o","path":"/https-la-gi-giai-thich-chi-tiet-ssl-tls-bang-chuyen-tinh-cho-va-meo"}},"next":{"frontmatter":{"title":"X√¢y d·ª±ng ph·∫ßn comment ƒë·∫≠m ch·∫•t dev v·ªõi github v√† giscus cho blog","path":"/xay-dung-phan-comment-dam-chat-dev-voi-github-va-giscus-cho-blog"}}},"pageContext":{"postId":"b22f4b39-b943-59eb-ade8-327f4f44f9dc","primaryTag":"Web","prevId":"e697616f-511e-5d17-8bdf-94c03da58633","nextId":"3023b4fe-7ff7-5c16-ab5e-c266f207b0ff"}},"staticQueryHashes":["1116962356","2275848304","3082461530","3089453468","545095672"]}